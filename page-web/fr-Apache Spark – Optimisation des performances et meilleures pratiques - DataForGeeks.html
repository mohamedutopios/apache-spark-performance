<!DOCTYPE html>
<!-- saved from url=(0103)https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Spark_Executor_memory -->
<html dir="ltr" lang="fr" prefix="og: https://ogp.me/ns#" class="translated-ltr"><plasmo-csui><template shadowrootmode="open"><style>.action-list{width:100%;flex-direction:column;padding:12px;list-style-type:none;display:none;position:relative}.action-list--has-items{display:flex}.action-list-item a,.action-list-item .button{width:100%;text-align:left;color:#fff;border-radius:10px;outline:none;align-items:center;gap:10px;padding:12px 20px;transition:all .2s ease-in-out;display:flex}.action-list-item--separator .button{cursor:default}.action-list-item:not(:last-of-type){margin-bottom:10px}.action-list-item__description{color:#ffffffb3;font-size:12px}.action-list-item__sub-action-list{opacity:0;gap:10px;margin:0 0 0 20px;transition:opacity .3s ease-in-out;display:flex}.action-list-item--has-actions .action-list-item__description{opacity:0;transition:opacity .3s ease-in-out}.action-list-item .button:focus-within,.action-list-item .button:focus,.action-list-item:hover .button{background-color:#ffffff14}.action-list-item .button:focus-within .action-list-item__sub-action-list,.action-list-item .button:focus .action-list-item__sub-action-list,.action-list-item:hover .action-list-item__sub-action-list,.action-list-item .button:focus .action-list-item__description,.action-list-item .button:focus-within .action-list-item__description,.action-list-item:hover .action-list-item__description{opacity:1}.action-list-item__sub-action{min-width:45px;min-height:21px;color:#fff;background-color:#ffffff14;border:1px solid #fff3;border-radius:4px;justify-content:center;align-items:center;padding:3px 10px;font-size:11px;transition:all .2s;display:flex}.action-list-item__sub-action:hover{background-color:#fff3}.summary__body{padding:40px}.summary--pending{animation:1.2s infinite alternate SummaryShimmer;-webkit-mask:linear-gradient(-50deg,#fff 30%,#ffffff98,#fff 70%) 100%/200% 100%;mask:linear-gradient(-50deg,#fff 30%,#ffffff98,#fff 70%) 100%/200% 100%}.summary__header{align-items:center;gap:15px;margin-bottom:20px;font-weight:500;display:flex}.summary__icon{width:23px;height:23px}.summary__pending-placeholder-text{margin-bottom:20px;position:relative}.summary__pending-placeholder-text span{display:block}.summary__list{margin:0;padding:0 0 0 14px;list-style-type:circle}.summary__content-wrapper{position:relative}.summary__content-wrapper .copy-button{z-index:2;position:absolute;top:8px;right:8px}.summary__content{z-index:1;word-wrap:break-word;white-space:pre-line;hyphens:auto;background-color:#ffffff0d;border:1px solid #ffffff1a;border-radius:6px;margin:0 0 35px;padding:25px 30px 25px 25px;font-size:14px;line-height:26px;position:relative;overflow:hidden}.summary__content code{background:#0003;border-radius:4px;padding:1px 4px}.summary__footer{gap:20px;margin:15px 0;display:flex}.summary__button--light{pointer-events:none;color:#fff;opacity:0;animation:.3s 3s forwards FadeInWithDelay}@keyframes FadeInWithDelay{to{pointer-events:all;opacity:1}}.summary__button{animation:2s 10 SummaryPulse}@keyframes SummaryShimmer{to{-webkit-mask-position:0}}@keyframes SummaryPulse{50%{box-shadow:0 0 60px #0006,0 0 0 20px #fff0,0 0 0 10px #fff0}to{box-shadow:0 0 60px #0006,0 0 #fff0,0 0 #fff0}}.bookmark-list{column-count:3;column-gap:20px;margin-bottom:50px;padding:30px}.bookmark-list .bookmark-list-item{margin-bottom:20px}.bookmark-list-item{break-inside:avoid;background-color:#ffffff0d;border:1px solid #ffffff1a;border-radius:6px;flex-direction:column;justify-content:space-between;transition:background-color .3s ease-in-out;display:flex;position:relative}.bookmark-list-item:hover{background-color:#ffffff14}.bookmark-list-item--small{backdrop-filter:blur(5px);background-color:#00000014;border:1px solid #0003;transform:scale(.8)}.bookmark-list-item--small .hljs{background-color:unset!important}.bookmark-list-item--dnd{max-height:470px;overflow:auto}.bookmark-list-item__actions{z-index:2;backdrop-filter:blur(2px);background-color:#0009;border:1px solid #ffffff26;border-radius:4px;flex-direction:column;justify-content:center;align-items:center;display:none;position:absolute;top:5px;right:5px;overflow:hidden}.bookmark-list-item__actions button{width:25px;height:25px;cursor:pointer;justify-content:center;align-items:center;display:flex}.bookmark-list-item__actions button:not(:last-child){border-bottom:1px solid #ffffff26}.bookmark-list-item__actions button:hover{background-color:#000c}.bookmark-list-item__copy-button svg{transform:scale(.75)}.bookmark-list-item:hover .bookmark-list-item__actions{display:flex}.bookmark-list-item__text{max-height:600px;word-wrap:break-word;white-space:pre-line;hyphens:auto;resize:none;color:#fff;padding:25px 15px;font-size:13px;line-height:23px;position:relative}.bookmark-list-item__color{cursor:pointer;grid-template-columns:repeat(5,1fr);padding:25px;display:grid}.bookmark-list-item__color__item{width:100%;padding-bottom:100%;transition:transform .2s}.bookmark-list-item__color__item:hover{transform:scale(1.2)}.bookmark-list-item pre code{border-radius:5px 5px 0 0;padding:15px 15px 25px;position:relative}.bookmark-list-item__img{width:100%;min-height:calc(100% - 49.5px);object-fit:cover;border-radius:7px 7px 0 0;padding:15px;display:block;overflow:hidden}.bookmark-list-item__footer a{color:#fffc;background-color:#ffffff03;border-top:1px solid #ffffff1a;border-radius:0 0 5px 5px;align-items:center;gap:10px;padding:10px;font-size:12px;display:flex;overflow:hidden}.bookmark-list-item--small .bookmark-list-item__footer a{color:#000;background-color:#00000003}.bookmark-list-item__footer img{width:22px;height:22px;object-fit:cover;border-radius:3px;flex-shrink:0;padding:2px;overflow:hidden}.bookmark-list-item__footer__page-title{font-weight:600}.bookmark-list-item__footer__page-url{color:#fff9;margin-top:3px;font-size:10px}.stack{z-index:99;width:350px;height:120px;margin:0 auto;font:13px Inter,--apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;position:fixed;bottom:20px;left:0;right:0}.stack__done-button.kome__button{width:86px;z-index:100;backdrop-filter:blur(3px);margin-left:auto;padding:4px;display:block;transform:scale(.9);box-shadow:0 0 60px #0006}.stack__done-button.kome__button span{min-width:unset;min-height:unset}.stack .bookmark-list-item{z-index:1;width:100%;height:calc(100% - 45px);background-color:#0006;border:1px solid #ffffff4d;transition:all .4s ease-in-out;position:absolute;bottom:0;transform:scale(1)}.stack .bookmark-list-item__img{height:220px}.stack .bookmark-list-item__text,.stack .bookmark-list-item>pre{height:220px;position:relative;overflow:auto}.stack .bookmark-list-item__text:after,.stack .bookmark-list-item>pre:after{content:"";width:100%;height:100%;position:absolute;bottom:0;left:0}.stack .wrapper>div:first-child{box-shadow:0 0 90px #00000080}.stack--has-items .wrapper>div:first-child{transform:matrix(.8,0,0,.8,0,15)}.stack--has-items .wrapper>div:nth-child(2){transform:matrix(.85,0,0,.85,0,10)}.stack--has-items .wrapper>div:nth-child(3){transform:matrix(.9,0,0,.9,0,5)}.stack .wrapper>div:last-of-type{animation:.7s cubic-bezier(0,1.11,.52,1.1) StackSlideIn}@keyframes StackSlideIn{0%{opacity:0;transform:translate(-30vw,-30vh)matrix(1.07,-.12,.91,.65,-3,-13)}to{opacity:1;box-shadow:unset;transform:matrix(1,0,0,1,0,0)}}.toast-wrapper{z-index:9999;font:13px Inter,--apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;position:absolute;top:0;left:0}.toast-message{max-width:300px;width:max-content;color:#fff;white-space:pre-line;backdrop-filter:blur(7px);background-color:#0009;border:1px solid #fff3;border-radius:6px;align-items:center;gap:10px;margin-bottom:10px;padding:6px 15px;display:flex;box-shadow:0 0 60px #0006}.toast-message--error{background-color:#ff4d4d4d;border-color:#ff4d4d66}.toast-message svg{width:21px;height:18px}.hljs-comment,.hljs-quote{color:#7e7887}.hljs-variable,.hljs-template-variable,.hljs-attribute,.hljs-regexp,.hljs-link,.hljs-tag,.hljs-name,.hljs-selector-id,.hljs-selector-class{color:#be4678}.hljs-number,.hljs-meta,.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-type,.hljs-params{color:#aa573c}.hljs-string,.hljs-symbol,.hljs-bullet{color:#2a9292}.hljs-title,.hljs-section{color:#576ddb}.hljs-keyword,.hljs-selector-tag{color:#955ae7}.hljs-deletion,.hljs-addition{color:#19171c;width:100%;display:inline-block}.hljs-deletion{background-color:#be4678}.hljs-addition{background-color:#2a9292}.hljs{color:#8b8792;background:#0000004d;padding:.5em;display:block;overflow-x:auto}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.header{z-index:1;position:sticky;top:0}.header__search-input-wrapper{border-bottom:1px solid #ffffff38;align-items:center;padding-left:15px;display:flex}.header__back-button{width:35px;height:27px;cursor:pointer;background-color:#ffffff1a;border:none;border-radius:4px;justify-content:center;align-items:center;display:flex}.header__back-button:hover{background-color:#ffffff2b}.header__search-input{width:100%;color:#fff;background:unset;border:none;padding:20px 17px;font:14px Inter,--apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif}.header__search-input:focus{outline:none}.header__search-input::placeholder{color:#fff9}.header .header__upgrade-button{position:absolute;top:10px;right:11px}.header .header__upgrade-button span{min-width:100px;max-width:160px;min-height:29px;max-height:29px;font-size:11px}.compose{height:100%}.compose--pending{animation:1.2s infinite alternate SummaryShimmer;-webkit-mask:linear-gradient(-50deg,#fff 30%,#ffffff98,#fff 70%) 100%/200% 100%;mask:linear-gradient(-50deg,#fff 30%,#ffffff98,#fff 70%) 100%/200% 100%}.compose__pending-placeholder-text{margin-bottom:20px;position:relative}.compose__pending-placeholder-text span{display:block}.compose__body{max-height:calc(75vh - 126px);white-space:pre-line;outline:none;padding:40px;font-size:14px;line-height:24px;overflow:auto}.compose__header{align-items:center;gap:15px;margin-bottom:20px;font-weight:500;display:flex}.compose__icon{width:23px;height:23px}.compose__content-wrapper{position:relative}.compose__content-wrapper .copy-button{z-index:2;position:absolute;top:8px;right:8px}.compose__content{z-index:1;word-wrap:break-word;white-space:pre-line;hyphens:auto;background-color:#ffffff0d;border:1px solid #ffffff1a;border-radius:6px;margin:0 0 35px;padding:25px 30px 25px 25px;font-size:14px;line-height:26px;position:relative;overflow:hidden}.compose__content code{background:#0003;border-radius:4px;padding:1px 4px}.compose__bookmarks{column-count:3;column-gap:20px}.compose__bookmark-button{cursor:pointer;position:relative}.compose__bookmark-button__order{z-index:3;width:25px;height:25px;color:#fff;background:#0000004d;border:1px solid #ffffff38;border-radius:100%;justify-content:center;align-items:center;font-size:11px;font-weight:500;display:flex;position:absolute;top:8px;right:8px;box-shadow:2px 2px 5px #0003}.compose__bookmarks .bookmark-list-item{margin-bottom:20px;transition:border .3s ease-in-out}.compose__footer{border-top:1px solid #ffffff38;justify-content:space-between;align-items:center;padding:15px 32px;display:flex;position:absolute;bottom:0;left:0;right:0}.compose__footer__actions{gap:15px;display:flex}.compose__footer__button--tweet{color:#fff;background-color:#1d9bf0;border:1px solid #ffffff1a;border-radius:20px;align-items:center;padding:8px 25px;font-weight:500;display:flex}.kome__button{color:#fff;border:1px solid #ffffff1a;border-radius:20px;padding:2px;font-weight:500;position:relative;overflow:hidden}.kome__button>span{min-width:150px;min-height:36px;max-height:36px;background:#0006;border-radius:20px;justify-content:center;align-items:center;gap:5px;padding:8px 25px;display:flex;position:relative}.kome__button--active{background:#ff353570;border-color:#0000}.kome__button--active span{background:linear-gradient(45deg,#ff35eb 0%,#ff3535 100%)}.kome__button--active:before{content:"";opacity:0;background:radial-gradient(42.94% 42.94%,#ffffffa6 31.77%,#fff0 91.67%);border-radius:20px;animation:3s linear infinite KomeButtonShine;display:block;position:absolute;inset:-2px}@keyframes KomeButtonShine{0%{opacity:0;transform:translate(-50%)rotate(0)}50%{opacity:1;transform:translate(120%)rotate(180deg)}to{opacity:0;transform:translate(-50%)rotate(360deg)}}.kome__input{min-width:310px;color:#fff;background-color:#0006;border:1px solid #ffffff4d;border-radius:40px;margin:auto;padding:14px 25px;font:500 14px Inter,--apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;display:block;box-shadow:0 0 30px #0003}.kome__input:focus{border:1px solid #ffffff80;outline:none}.login-form{flex-direction:column;justify-content:center;align-items:center;display:flex}.login-form__title{margin:35px 0 25px}.login-form .kome__input{margin-bottom:25px}.login-form .kome__button{width:100%}.login-form .kome__button span{padding:10px 25px}.login-form__signup-button{color:#fff;margin-top:15px}.login-form__forgot-link{border-top:1px solid #fff3;margin-top:15px;padding:10px 20px;display:block}.signup-form{flex-direction:column;justify-content:center;align-items:center;display:flex}.signup-form__title{margin:25px 0}.signup-form .kome__input{margin-bottom:25px}.signup-form .kome__button{width:100%}.signup-form .kome__button span{padding:10px 25px}.signup-form__login-button{color:#fff;margin-top:15px}.signup-form__consent{max-width:310px;color:#ffffffe6;text-align:center;margin-top:15px;font-size:10px;line-height:17px}.compose-button{cursor:pointer;position:relative}.compose-button__placeholder{color:#ffffff80}.compose-button__type-popup{z-index:100;color:#fff;background-color:#000000b3;border:1px solid #fff3;border-radius:6px;margin:auto;padding:10px;position:absolute;bottom:45px;left:0;right:0}.compose-button__type-popup:before{content:"";z-index:100;width:0;height:0;border-top:5px solid #fff3;border-left:5px solid #0000;border-right:5px solid #0000;display:block;position:absolute;bottom:-6px;right:calc(50% - 2.5px)}.compose-button__type-popup-item{text-align:center;border-radius:4px;padding:6px 10px;transition:all .2s ease-in-out}.compose-button__type-popup-item:hover{background-color:#ffffff14}.footer{width:100%;height:50px;border-top:1px solid #ffffff38;justify-content:space-between;align-items:center;padding:0 10px;display:flex}.footer__profile-button,.footer__kome-button{width:25px;height:25px;cursor:pointer;background-color:#ffffff1a;border:none;border-radius:7px;justify-content:center;align-items:center;display:flex}.footer__profile-button:hover,.footer__kome-button:hover{background-color:#fff3}.profile--pending{animation:1.2s infinite alternate SummaryShimmer;-webkit-mask:linear-gradient(-50deg,#fff 30%,#ffffff98,#fff 70%) 100%/200% 100%;mask:linear-gradient(-50deg,#fff 30%,#ffffff98,#fff 70%) 100%/200% 100%}.profile .kome__content{flex-direction:column;padding:40px 40px 25px;display:flex}.profile__placeholder{width:60%;height:150px;background:#ffffff1a}.profile__user{align-items:center;gap:20px;display:flex}.profile__user__avatar{width:55px;height:55px;background:#ffffff0e;border:1px solid #ffffff4d;border-radius:50%;padding:5px}.profile__user__name{font-size:18px;font-weight:500}.profile__user__email{margin-top:5px}.profile__actions{gap:15px;margin:35px 0;display:flex}.profile__actions .kome__button span{min-width:fit-content;padding:6px 21px;font-size:12px}.profile__quota{margin-top:35px}.profile__quota__bar{width:280px;max-width:100%;height:10px;background:#ffffff1a;border-radius:5px;margin-bottom:10px;display:flex}.profile__quota__bar__fill{height:100%;background:#ff6b6b;border-radius:5px}.profile__quota__text{color:#fffc;margin-top:10px;font-size:12px;font-weight:500}.kome__version{color:#ffffffb3;gap:10px;margin-top:auto;font-size:11px;display:flex}.kome__version a{text-decoration:underline}.paywall .kome__content{padding:50px 60px}.paywall__intro{margin-bottom:20px}.paywall__intro h2{margin-bottom:15px;line-height:30px}.paywall__intro p{max-width:70%;line-height:24px}.paywall__why{grid-template-columns:1fr 1fr 1fr;gap:15px;margin-bottom:20px;display:grid}.paywall__why p{text-align:center;background-color:#ffffff0d;border:1px solid #ffffff1a;border-radius:6px;margin-bottom:15px;padding:25px 30px 25px 25px}.paywall__button{width:max-content;text-align:center}.paywall__button__note{opacity:.85;margin-top:6px;font-size:11px}*{box-sizing:border-box;margin:0;padding:0}button{cursor:pointer;background:0 0;border:none;font:13px Inter,--apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif}textarea{background:0 0;border:none;font:13px Inter,--apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif}textarea:focus{outline:none}.modal__backdrop{z-index:-1;background-color:#00000040;position:fixed;inset:0}.modal{--kome-content-height:50vh;z-index:1;width:50vw;min-width:800px;height:var(--kome-content-height);backdrop-filter:blur(6px);color:#fff;background:linear-gradient(45deg,#0c070fcc 19%,#2a2a2abf 81%);border-radius:14px;margin:auto;font:13px Inter,--apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;transition:width .4s ease-in-out,height .4s ease-in-out;animation:.4s ease-in-out modalFadeSlideIn;position:fixed;inset:0;overflow-y:auto;box-shadow:0 0 100px #0000004d,1px 1px #0006,1px 1px #ffffff80,-1px -1px #0006,-1px -1px #fff9}.modal--view--compose{width:70vw;min-width:800px;--kome-content-height:75vh}.modal--view--summary{--kome-content-height:65vh}.modal--view--bookmarks{--kome-content-height:55vh}.modal--view--login .modal__body,.modal--view--signup .modal__body{flex-direction:column;justify-content:center;align-items:center;padding:20px 0;display:flex}.modal__body{z-index:1;min-height:100%;position:relative}.kome__content{height:calc(var(--kome-content-height) - 57px - 51px);overflow:auto}.image-grid{grid-template-columns:1fr 1fr 1fr;gap:15px;display:grid}.image-grid img{width:100%;height:250px;object-fit:contain}a{color:inherit;text-decoration:none}.animation--flip-in{animation:4.5s linear 10 AnimationFlipIn}@keyframes AnimationFlipIn{0%{opacity:0;transform:translateY(-5px)}20%{opacity:1;transform:translateY(0)}}@keyframes modalFadeSlideIn{0%{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}</style><div id="plasmo-shadow-container" style="z-index: 2147483647; position: relative;"><div id="plasmo-overlay-0" class="plasmo-csui-container" style="display: flex; position: absolute; top: 0px; left: 0px;"></div></div></template></plasmo-csui><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	
		<!-- All in One SEO 4.5.8 - aioseo.com -->
		<meta name="description" content="Note: This article is a compilation effort of multiple performance tuning methodologies in Apache Spark. Text/Images in following article has been referred from various interesting articles and book, details of which are captured under &quot;References&quot;. Tweak Configurations Viewing and Setting Apache Spark Configurations 4 ways of doing it : Way-1:Using $SPARK_HOME directory (Configuration changes in">
		<meta name="robots" content="max-image-preview:large">
		<link rel="canonical" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/">
		<meta name="generator" content="All in One SEO (AIOSEO) 4.5.8">
		<meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="DataForGeeks - for Data Enthusiasts">
		<meta property="og:type" content="article">
		<meta property="og:title" content="Apache Spark – Performance Tuning and Best Practices - DataForGeeks">
		<meta property="og:description" content="Note: This article is a compilation effort of multiple performance tuning methodologies in Apache Spark. Text/Images in following article has been referred from various interesting articles and book, details of which are captured under &quot;References&quot;. Tweak Configurations Viewing and Setting Apache Spark Configurations 4 ways of doing it : Way-1:Using $SPARK_HOME directory (Configuration changes in">
		<meta property="og:url" content="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/">
		<meta property="article:published_time" content="2022-05-04T12:33:18+00:00">
		<meta property="article:modified_time" content="2022-05-16T21:19:34+00:00">
		<meta name="twitter:card" content="summary_large_image">
		<meta name="twitter:title" content="Apache Spark – Performance Tuning and Best Practices - DataForGeeks">
		<meta name="twitter:description" content="Note: This article is a compilation effort of multiple performance tuning methodologies in Apache Spark. Text/Images in following article has been referred from various interesting articles and book, details of which are captured under &quot;References&quot;. Tweak Configurations Viewing and Setting Apache Spark Configurations 4 ways of doing it : Way-1:Using $SPARK_HOME directory (Configuration changes in">
		<script src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/f.txt"></script><script src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/f(1).txt"></script><script type="text/javascript" async="" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/library(1).js"></script><script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"BlogPosting","@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/#blogposting","name":"Apache Spark \u2013 Performance Tuning and Best Practices - DataForGeeks","headline":"Apache Spark &#8211; Performance Tuning and Best Practices","author":{"@id":"https:\/\/dataforgeeks.com\/author\/nikhilaggarwal\/#author"},"publisher":{"@id":"https:\/\/dataforgeeks.com\/#organization"},"image":{"@type":"ImageObject","url":"https:\/\/dataforgeeks.com\/wp-content\/uploads\/2022\/05\/spark-1-tuning_spark_image.jpg","@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/#articleImage","width":800,"height":405},"datePublished":"2022-05-04T12:33:18+00:00","dateModified":"2022-05-16T21:19:34+00:00","inLanguage":"en-US","commentCount":1,"mainEntityOfPage":{"@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/#webpage"},"isPartOf":{"@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/#webpage"},"articleSection":"General, apache spark, big data, bigdata, optimisation, partition, spark, tuning"},{"@type":"BreadcrumbList","@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/dataforgeeks.com\/#listItem","position":1,"name":"Home","item":"https:\/\/dataforgeeks.com\/","nextItem":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/#listItem"},{"@type":"ListItem","@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/#listItem","position":2,"name":"Apache Spark - Performance Tuning and Best Practices","previousItem":"https:\/\/dataforgeeks.com\/#listItem"}]},{"@type":"Organization","@id":"https:\/\/dataforgeeks.com\/#organization","name":"DataForGeeks","url":"https:\/\/dataforgeeks.com\/"},{"@type":"Person","@id":"https:\/\/dataforgeeks.com\/author\/nikhilaggarwal\/#author","url":"https:\/\/dataforgeeks.com\/author\/nikhilaggarwal\/","name":"Nikhil Aggarwal","image":{"@type":"ImageObject","@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/016ca5b64577f70665b090b10f01e648?s=96&d=mm&r=g","width":96,"height":96,"caption":"Nikhil Aggarwal"}},{"@type":"WebPage","@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/#webpage","url":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/","name":"Apache Spark \u2013 Performance Tuning and Best Practices - DataForGeeks","description":"Note: This article is a compilation effort of multiple performance tuning methodologies in Apache Spark. Text\/Images in following article has been referred from various interesting articles and book, details of which are captured under \"References\". Tweak Configurations Viewing and Setting Apache Spark Configurations 4 ways of doing it : Way-1:Using $SPARK_HOME directory (Configuration changes in","inLanguage":"en-US","isPartOf":{"@id":"https:\/\/dataforgeeks.com\/#website"},"breadcrumb":{"@id":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/#breadcrumblist"},"author":{"@id":"https:\/\/dataforgeeks.com\/author\/nikhilaggarwal\/#author"},"creator":{"@id":"https:\/\/dataforgeeks.com\/author\/nikhilaggarwal\/#author"},"datePublished":"2022-05-04T12:33:18+00:00","dateModified":"2022-05-16T21:19:34+00:00"},{"@type":"WebSite","@id":"https:\/\/dataforgeeks.com\/#website","url":"https:\/\/dataforgeeks.com\/","name":"DataForGeeks","description":"for Data Enthusiasts","inLanguage":"en-US","publisher":{"@id":"https:\/\/dataforgeeks.com\/#organization"}}]}
		</script>
		<!-- All in One SEO -->

<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- This site is optimized with the Yoast SEO plugin v22.2 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks</title><link rel="preload" as="style" href="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/css"><link rel="stylesheet" href="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/css" media="all" onload="this.media=&#39;all&#39;"><noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open%20Sans%3A300%2C300italic%2Cregular%2Citalic%2C600%2C600italic%2C700%2C700italic%2C800%2C800italic&#038;display=swap" /></noscript><link rel="stylesheet" href="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/93461615c37d5719ea63ed746b4abb1d.css" media="all" data-minify="1">
	<link rel="canonical" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Apache Spark - Performance Tuning and Best Practices - DataForGeeks">
	<meta property="og:description" content="Note: This article is a compilation effort of multiple performance tuning methodologies in Apache Spark. Text/Images in following article has been referred from various interesting articles and book, details of which are captured under “References”. Tweak Configurations Viewing and Setting Apache Spark Configurations 4 ways of doing it : Way-1:Using $SPARK_HOME directory (Configuration changes in ... Read more">
	<meta property="og:url" content="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/">
	<meta property="og:site_name" content="DataForGeeks">
	<meta property="article:author" content="https://www.facebook.com/nikhil0711">
	<meta property="article:published_time" content="2022-05-04T12:33:18+00:00">
	<meta property="article:modified_time" content="2022-05-16T21:19:34+00:00">
	<meta property="og:image" content="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image.jpg">
	<meta name="author" content="Nikhil Aggarwal">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:creator" content="@nikhil0711">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Nikhil Aggarwal">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="21 minutes">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/","url":"https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/","name":"Apache Spark - Performance Tuning and Best Practices - DataForGeeks","isPartOf":{"@id":"https://dataforgeeks.com/#website"},"primaryImageOfPage":{"@id":"https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#primaryimage"},"image":{"@id":"https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#primaryimage"},"thumbnailUrl":"https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image.jpg","datePublished":"2022-05-04T12:33:18+00:00","dateModified":"2022-05-16T21:19:34+00:00","author":{"@id":"https://dataforgeeks.com/#/schema/person/ae74f1c10c65d4f465e8f1b929862fcd"},"breadcrumb":{"@id":"https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#primaryimage","url":"https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image.jpg","contentUrl":"https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image.jpg","width":800,"height":405},{"@type":"BreadcrumbList","@id":"https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://dataforgeeks.com/"},{"@type":"ListItem","position":2,"name":"Apache Spark &#8211; Performance Tuning and Best Practices"}]},{"@type":"WebSite","@id":"https://dataforgeeks.com/#website","url":"https://dataforgeeks.com/","name":"DataForGeeks","description":"for Data Enthusiasts","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://dataforgeeks.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https://dataforgeeks.com/#/schema/person/ae74f1c10c65d4f465e8f1b929862fcd","name":"Nikhil Aggarwal","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://dataforgeeks.com/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/016ca5b64577f70665b090b10f01e648?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/016ca5b64577f70665b090b10f01e648?s=96&d=mm&r=g","caption":"Nikhil Aggarwal"},"sameAs":["http://www.dataforgeeks.com","https://www.facebook.com/nikhil0711","https://www.linkedin.com/in/nikhil0711/","https://twitter.com/nikhil0711"],"url":"https://dataforgeeks.com/author/nikhilaggarwal/"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://www.googletagmanager.com/">
<link rel="dns-prefetch" href="https://pagead2.googlesyndication.com/">
<link href="https://fonts.gstatic.com/" crossorigin="" rel="preconnect">
<link href="https://fonts.googleapis.com/" crossorigin="" rel="preconnect">
<link rel="alternate" type="application/rss+xml" title="DataForGeeks » Flux" href="https://dataforgeeks.com/feed/">
<link rel="alternate" type="application/rss+xml" title="DataForGeeks » Flux de commentaires" href="https://dataforgeeks.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="DataForGeeks » Apache Spark – Optimisation des performances et meilleures pratiques Flux de commentaires" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/feed/">
		<!-- This site uses the Google Analytics by MonsterInsights plugin v8.26.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/js" data-cfasync="false" data-wpfc-render="false" async=""></script>
			<script data-cfasync="false" data-wpfc-render="false">
				var mi_version = '8.26.0';
				var mi_track_user = true;
				var mi_no_track_reason = '';
								var MonsterInsightsDefaultLocations = {"page_location":"https:\/\/dataforgeeks.com\/apache-spark-performance-tuning-and-best-practices\/2305\/"};
				if ( typeof MonsterInsightsPrivacyGuardFilter === 'function' ) {
					var MonsterInsightsLocations = (typeof MonsterInsightsExcludeQuery === 'object') ? MonsterInsightsPrivacyGuardFilter( MonsterInsightsExcludeQuery ) : MonsterInsightsPrivacyGuardFilter( MonsterInsightsDefaultLocations );
				} else {
					var MonsterInsightsLocations = (typeof MonsterInsightsExcludeQuery === 'object') ? MonsterInsightsExcludeQuery : MonsterInsightsDefaultLocations;
				}

								var disableStrs = [
										'ga-disable-G-MTCC3ZV3SQ',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for (var index = 0; index < disableStrs.length; index++) {
						if (document.cookie.indexOf(disableStrs[index] + '=true') > -1) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if (__gtagTrackerIsOptedOut()) {
					for (var index = 0; index < disableStrs.length; index++) {
						window[disableStrs[index]] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for (var index = 0; index < disableStrs.length; index++) {
						document.cookie = disableStrs[index] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[disableStrs[index]] = true;
					}
				}

				if ('undefined' === typeof gaOptout) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if (mi_track_user) {
					function __gtagDataLayer() {
						dataLayer.push(arguments);
					}

					function __gtagTracker(type, name, parameters) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply(null, arguments);
							return;
						}

						if (type === 'event') {
														parameters.send_to = monsterinsights_frontend.v4_id;
							var hookName = name;
							if (typeof parameters['event_category'] !== 'undefined') {
								hookName = parameters['event_category'] + ':' + name;
							}

							if (typeof MonsterInsightsDualTracker.trackers[hookName] !== 'undefined') {
								MonsterInsightsDualTracker.trackers[hookName](parameters);
							} else {
								__gtagDataLayer('event', name, parameters);
							}
							
						} else {
							__gtagDataLayer.apply(null, arguments);
						}
					}

					__gtagTracker('js', new Date());
					__gtagTracker('set', {
						'developer_id.dZGIzZG': true,
											});
					if ( MonsterInsightsLocations.page_location ) {
						__gtagTracker('set', MonsterInsightsLocations);
					}
										__gtagTracker('config', 'G-MTCC3ZV3SQ', {"forceSSL":"true","link_attribution":"true"} );
															window.gtag = __gtagTracker;										(function () {
						/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
						/* ga and __gaTracker compatibility shim. */
						var noopfn = function () {
							return null;
						};
						var newtracker = function () {
							return new Tracker();
						};
						var Tracker = function () {
							return null;
						};
						var p = Tracker.prototype;
						p.get = noopfn;
						p.set = noopfn;
						p.send = function () {
							var args = Array.prototype.slice.call(arguments);
							args.unshift('send');
							__gaTracker.apply(null, args);
						};
						var __gaTracker = function () {
							var len = arguments.length;
							if (len === 0) {
								return;
							}
							var f = arguments[len - 1];
							if (typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function') {
								if ('send' === arguments[0]) {
									var hitConverted, hitObject = false, action;
									if ('event' === arguments[1]) {
										if ('undefined' !== typeof arguments[3]) {
											hitObject = {
												'eventAction': arguments[3],
												'eventCategory': arguments[2],
												'eventLabel': arguments[4],
												'value': arguments[5] ? arguments[5] : 1,
											}
										}
									}
									if ('pageview' === arguments[1]) {
										if ('undefined' !== typeof arguments[2]) {
											hitObject = {
												'eventAction': 'page_view',
												'page_path': arguments[2],
											}
										}
									}
									if (typeof arguments[2] === 'object') {
										hitObject = arguments[2];
									}
									if (typeof arguments[5] === 'object') {
										Object.assign(hitObject, arguments[5]);
									}
									if ('undefined' !== typeof arguments[1].hitType) {
										hitObject = arguments[1];
										if ('pageview' === hitObject.hitType) {
											hitObject.eventAction = 'page_view';
										}
									}
									if (hitObject) {
										action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
										hitConverted = mapArgs(hitObject);
										__gtagTracker('event', action, hitConverted);
									}
								}
								return;
							}

							function mapArgs(args) {
								var arg, hit = {};
								var gaMap = {
									'eventCategory': 'event_category',
									'eventAction': 'event_action',
									'eventLabel': 'event_label',
									'eventValue': 'event_value',
									'nonInteraction': 'non_interaction',
									'timingCategory': 'event_category',
									'timingVar': 'name',
									'timingValue': 'value',
									'timingLabel': 'event_label',
									'page': 'page_path',
									'location': 'page_location',
									'title': 'page_title',
									'referrer' : 'page_referrer',
								};
								for (arg in args) {
																		if (!(!args.hasOwnProperty(arg) || !gaMap.hasOwnProperty(arg))) {
										hit[gaMap[arg]] = args[arg];
									} else {
										hit[arg] = args[arg];
									}
								}
								return hit;
							}

							try {
								f.hitCallback();
							} catch (ex) {
							}
						};
						__gaTracker.create = newtracker;
						__gaTracker.getByName = newtracker;
						__gaTracker.getAll = function () {
							return [];
						};
						__gaTracker.remove = noopfn;
						__gaTracker.loaded = true;
						window['__gaTracker'] = __gaTracker;
					})();
									} else {
										console.log("");
					(function () {
						function __gtagTracker() {
							return null;
						}

						window['__gtagTracker'] = __gtagTracker;
						window['gtag'] = __gtagTracker;
					})();
									}
			</script><script type="text/javascript" src="chrome-extension://mdnleldcmiljblolnjhpnblkcekpdkpa/libs/customElements.js" class="__REQUESTLY__SCRIPT"></script>
				<!-- / Google Analytics by MonsterInsights -->
		
<style id="wp-emoji-styles-inline-css">

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>

<style id="classic-theme-styles-inline-css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--contrast: var(--contrast);--wp--preset--color--contrast-2: var(--contrast-2);--wp--preset--color--contrast-3: var(--contrast-3);--wp--preset--color--base: var(--base);--wp--preset--color--base-2: var(--base-2);--wp--preset--color--base-3: var(--base-3);--wp--preset--color--accent: var(--accent);--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>



<style id="ez-toc-inline-css">
div#ez-toc-container .ez-toc-title {font-size: 120%;}div#ez-toc-container .ez-toc-title {font-weight: 500;}div#ez-toc-container ul li {font-size: 95%;}div#ez-toc-container ul li {font-weight: 500;}div#ez-toc-container nav ul ul li {font-size: 90%;}
.ez-toc-container-direction {direction: ltr;}.ez-toc-counter ul{counter-reset: item ;}.ez-toc-counter nav ul li a::before {content: counters(item, ".", decimal) ". ";display: inline-block;counter-increment: item;flex-grow: 0;flex-shrink: 0;margin-right: .2em; float: left; }.ez-toc-widget-direction {direction: ltr;}.ez-toc-widget-container ul{counter-reset: item ;}.ez-toc-widget-container nav ul li a::before {content: counters(item, ".", decimal) ". ";display: inline-block;counter-increment: item;flex-grow: 0;flex-shrink: 0;margin-right: .2em; float: left; }
</style>


<style id="generate-style-inline-css">
body{background-color:#efefef;color:#3a3a3a;}a{color:#1e73be;}a:hover, a:focus, a:active{color:#000000;}body .grid-container{max-width:1490px;}.wp-block-group__inner-container{max-width:1490px;margin-left:auto;margin-right:auto;}.generate-back-to-top{font-size:20px;border-radius:3px;position:fixed;bottom:30px;right:30px;line-height:40px;width:40px;text-align:center;z-index:10;transition:opacity 300ms ease-in-out;opacity:0.1;transform:translateY(1000px);}.generate-back-to-top__show{opacity:1;transform:translateY(0);}:root{--contrast:#222222;--contrast-2:#575760;--contrast-3:#b2b2be;--base:#f0f0f0;--base-2:#f7f8f9;--base-3:#ffffff;--accent:#1e73be;}:root .has-contrast-color{color:var(--contrast);}:root .has-contrast-background-color{background-color:var(--contrast);}:root .has-contrast-2-color{color:var(--contrast-2);}:root .has-contrast-2-background-color{background-color:var(--contrast-2);}:root .has-contrast-3-color{color:var(--contrast-3);}:root .has-contrast-3-background-color{background-color:var(--contrast-3);}:root .has-base-color{color:var(--base);}:root .has-base-background-color{background-color:var(--base);}:root .has-base-2-color{color:var(--base-2);}:root .has-base-2-background-color{background-color:var(--base-2);}:root .has-base-3-color{color:var(--base-3);}:root .has-base-3-background-color{background-color:var(--base-3);}:root .has-accent-color{color:var(--accent);}:root .has-accent-background-color{background-color:var(--accent);}body, button, input, select, textarea{font-family:"Open Sans", sans-serif;font-size:16px;}body{line-height:1.5;}p{margin-bottom:0.7em;}.entry-content > [class*="wp-block-"]:not(:last-child):not(.wp-block-heading){margin-bottom:0.7em;}.main-title{font-size:45px;}.main-navigation .main-nav ul ul li a{font-size:14px;}.widget-title{font-size:19px;margin-bottom:10px;}.sidebar .widget, .footer-widgets .widget{font-size:14px;}h1{font-weight:400;font-size:40px;}h2{font-weight:300;font-size:30px;}h3{font-size:20px;}h4{font-size:inherit;}h5{font-size:inherit;}@media (max-width:768px){.main-title{font-size:30px;}h1{font-size:30px;}h2{font-size:25px;}}.top-bar{background-color:#636363;color:#ffffff;}.top-bar a{color:#ffffff;}.top-bar a:hover{color:#303030;}.site-header{background-color:#ffffff;color:#3a3a3a;}.site-header a{color:#3a3a3a;}.main-title a,.main-title a:hover{color:#222222;}.site-description{color:#757575;}.main-navigation,.main-navigation ul ul{background-color:#1e73be;}.main-navigation .main-nav ul li a, .main-navigation .menu-toggle, .main-navigation .menu-bar-items{color:#ffffff;}.main-navigation .main-nav ul li:not([class*="current-menu-"]):hover > a, .main-navigation .main-nav ul li:not([class*="current-menu-"]):focus > a, .main-navigation .main-nav ul li.sfHover:not([class*="current-menu-"]) > a, .main-navigation .menu-bar-item:hover > a, .main-navigation .menu-bar-item.sfHover > a{color:#ffffff;background-color:#035a9e;}button.menu-toggle:hover,button.menu-toggle:focus,.main-navigation .mobile-bar-items a,.main-navigation .mobile-bar-items a:hover,.main-navigation .mobile-bar-items a:focus{color:#ffffff;}.main-navigation .main-nav ul li[class*="current-menu-"] > a{color:#ffffff;background-color:#035a9e;}.navigation-search input[type="search"],.navigation-search input[type="search"]:active, .navigation-search input[type="search"]:focus, .main-navigation .main-nav ul li.search-item.active > a, .main-navigation .menu-bar-items .search-item.active > a{color:#ffffff;background-color:#035a9e;}.main-navigation ul ul{background-color:#035a9e;}.main-navigation .main-nav ul ul li a{color:#ffffff;}.main-navigation .main-nav ul ul li:not([class*="current-menu-"]):hover > a,.main-navigation .main-nav ul ul li:not([class*="current-menu-"]):focus > a, .main-navigation .main-nav ul ul li.sfHover:not([class*="current-menu-"]) > a{color:#bbd2e8;background-color:#035a9e;}.main-navigation .main-nav ul ul li[class*="current-menu-"] > a{color:#bbd2e8;background-color:#035a9e;}.separate-containers .inside-article, .separate-containers .comments-area, .separate-containers .page-header, .one-container .container, .separate-containers .paging-navigation, .inside-page-header{background-color:#ffffff;}.entry-meta{color:#595959;}.entry-meta a{color:#595959;}.entry-meta a:hover{color:#1e73be;}.sidebar .widget{background-color:#ffffff;}.sidebar .widget .widget-title{color:#000000;}.footer-widgets{background-color:#ffffff;}.footer-widgets .widget-title{color:#000000;}.site-info{color:#ffffff;background-color:#222222;}.site-info a{color:#ffffff;}.site-info a:hover{color:#606060;}.footer-bar .widget_nav_menu .current-menu-item a{color:#606060;}input[type="text"],input[type="email"],input[type="url"],input[type="password"],input[type="search"],input[type="tel"],input[type="number"],textarea,select{color:#666666;background-color:#fafafa;border-color:#cccccc;}input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="number"]:focus,textarea:focus,select:focus{color:#666666;background-color:#ffffff;border-color:#bfbfbf;}button,html input[type="button"],input[type="reset"],input[type="submit"],a.button,a.wp-block-button__link:not(.has-background){color:#ffffff;background-color:#666666;}button:hover,html input[type="button"]:hover,input[type="reset"]:hover,input[type="submit"]:hover,a.button:hover,button:focus,html input[type="button"]:focus,input[type="reset"]:focus,input[type="submit"]:focus,a.button:focus,a.wp-block-button__link:not(.has-background):active,a.wp-block-button__link:not(.has-background):focus,a.wp-block-button__link:not(.has-background):hover{color:#ffffff;background-color:#3f3f3f;}a.generate-back-to-top{background-color:rgba( 0,0,0,0.4 );color:#ffffff;}a.generate-back-to-top:hover,a.generate-back-to-top:focus{background-color:rgba( 0,0,0,0.6 );color:#ffffff;}:root{--gp-search-modal-bg-color:var(--base-3);--gp-search-modal-text-color:var(--contrast);--gp-search-modal-overlay-bg-color:rgba(0,0,0,0.2);}@media (max-width: 768px){.main-navigation .menu-bar-item:hover > a, .main-navigation .menu-bar-item.sfHover > a{background:none;color:#ffffff;}}.inside-top-bar{padding:10px;}.inside-header{padding:40px;}.site-main .wp-block-group__inner-container{padding:40px;}.entry-content .alignwide, body:not(.no-sidebar) .entry-content .alignfull{margin-left:-40px;width:calc(100% + 80px);max-width:calc(100% + 80px);}.separate-containers .widget, .separate-containers .site-main > *, .separate-containers .page-header, .widget-area .main-navigation{margin-bottom:13px;}.separate-containers .site-main{margin:13px;}.both-right.separate-containers .inside-left-sidebar{margin-right:6px;}.both-right.separate-containers .inside-right-sidebar{margin-left:6px;}.both-left.separate-containers .inside-left-sidebar{margin-right:6px;}.both-left.separate-containers .inside-right-sidebar{margin-left:6px;}.separate-containers .page-header-image, .separate-containers .page-header-contained, .separate-containers .page-header-image-single, .separate-containers .page-header-content-single{margin-top:13px;}.separate-containers .inside-right-sidebar, .separate-containers .inside-left-sidebar{margin-top:13px;margin-bottom:13px;}.rtl .menu-item-has-children .dropdown-menu-toggle{padding-left:20px;}.rtl .main-navigation .main-nav ul li.menu-item-has-children > a{padding-right:20px;}.site-info{padding:20px;}@media (max-width:768px){.separate-containers .inside-article, .separate-containers .comments-area, .separate-containers .page-header, .separate-containers .paging-navigation, .one-container .site-content, .inside-page-header{padding:30px;}.site-main .wp-block-group__inner-container{padding:30px;}.site-info{padding-right:10px;padding-left:10px;}.entry-content .alignwide, body:not(.no-sidebar) .entry-content .alignfull{margin-left:-30px;width:calc(100% + 60px);max-width:calc(100% + 60px);}}.one-container .sidebar .widget{padding:0px;}@media (max-width: 768px){.main-navigation .menu-toggle,.main-navigation .mobile-bar-items,.sidebar-nav-mobile:not(#sticky-placeholder){display:block;}.main-navigation ul,.gen-sidebar-nav{display:none;}[class*="nav-float-"] .site-header .inside-header > *{float:none;clear:both;}}
.main-navigation .slideout-toggle a:before,.slide-opened .slideout-overlay .slideout-exit:before{font-family:GeneratePress;}.slideout-navigation .dropdown-menu-toggle:before{content:"\f107" !important;}.slideout-navigation .sfHover > a .dropdown-menu-toggle:before{content:"\f106" !important;}
.navigation-branding .main-title{font-weight:bold;text-transform:none;font-size:45px;}@media (max-width: 768px){.navigation-branding .main-title{font-size:30px;}}
.main-navigation .main-nav ul li a,.menu-toggle,.main-navigation .mobile-bar-items a{transition: line-height 300ms ease}.main-navigation.toggled .main-nav > ul{background-color: #1e73be}
.post-image, .page-content, .entry-content, .entry-summary, footer.entry-meta{margin-top:2.5em;}.post-image-above-header .inside-article div.featured-image, .post-image-above-header .inside-article div.post-image{margin-bottom:2.5em;}
</style>






<style id="rocket-lazyload-inline-css">
.rll-youtube-player{position:relative;padding-bottom:56.23%;height:0;overflow:hidden;max-width:100%;}.rll-youtube-player:focus-within{outline: 2px solid currentColor;outline-offset: 5px;}.rll-youtube-player iframe{position:absolute;top:0;left:0;width:100%;height:100%;z-index:100;background:0 0}.rll-youtube-player img{bottom:0;display:block;left:0;margin:auto;max-width:100%;width:100%;position:absolute;right:0;top:0;border:none;height:auto;-webkit-transition:.4s all;-moz-transition:.4s all;transition:.4s all}.rll-youtube-player img:hover{-webkit-filter:brightness(75%)}.rll-youtube-player .play{height:100%;width:100%;left:0;top:0;position:absolute;background:url(https://dataforgeeks.com/wp-content/plugins/wp-rocket/assets/img/youtube.png) no-repeat center;background-color: transparent !important;cursor:pointer;border:none;}.wp-embed-responsive .wp-has-aspect-ratio .rll-youtube-player{position:absolute;padding-bottom:0;width:100%;height:100%;top:0;bottom:0;left:0;right:0}
</style>
<script src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/jquery.min.js" id="jquery-core-js"></script>




<!-- Google tag (gtag.js) snippet added by Site Kit -->

<!-- Google Analytics snippet added by Site Kit -->
<script src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/js(1)" id="google_gtagjs-js" async=""></script>
<script id="google_gtagjs-js-after">
window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}
gtag("set","linker",{"domains":["dataforgeeks.com"]});
gtag("js", new Date());
gtag("set", "developer_id.dZTNiMT", true);
gtag("config", "GT-MQX89S3");
</script>

<!-- End Google tag (gtag.js) snippet added by Site Kit -->
<link rel="https://api.w.org/" href="https://dataforgeeks.com/wp-json/"><link rel="alternate" type="application/json" href="https://dataforgeeks.com/wp-json/wp/v2/posts/2305"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://dataforgeeks.com/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.5.2">
<link rel="shortlink" href="https://dataforgeeks.com/?p=2305">
<link rel="alternate" type="application/json+oembed" href="https://dataforgeeks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdataforgeeks.com%2Fapache-spark-performance-tuning-and-best-practices%2F2305%2F">
<link rel="alternate" type="text/xml+oembed" href="https://dataforgeeks.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdataforgeeks.com%2Fapache-spark-performance-tuning-and-best-practices%2F2305%2F&amp;format=xml">
<meta name="generator" content="Site Kit by Google 1.125.0">
 <!-- OneAll.com / Social Login for WordPress / v5.7 -->

<style>.oneall_social_login + p.comment-notes{margin-top: 10px !important;}#login #loginform .oneall_social_login{background-color: rgba(0, 0, 0, 0.04);padding: 10px 10px 0 10px;margin-bottom: 10px;border: 1px solid rgba(0, 0, 0, 0.06);border-radius: 4px;}</style><link rel="pingback" href="https://dataforgeeks.com/xmlrpc.php">

<!-- Google AdSense meta tags added by Site Kit -->
<meta name="google-adsense-platform-account" content="ca-host-pub-2644536267352236">
<meta name="google-adsense-platform-domain" content="sitekit.withgoogle.com">
<!-- End Google AdSense meta tags added by Site Kit -->

<!-- Google AdSense snippet added by Site Kit -->
<script async="" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/f(2).txt" crossorigin="anonymous" data-checked-head="true"></script>

<!-- End Google AdSense snippet added by Site Kit -->
		<style id="wp-custom-css">
			hr{
	margin-bottom:20px;
	margin-top:20px
}
table { /* tables still need 'cellspacing="0"' in the markup */
	border-collapse: separate;
	border-spacing: 0;
	font-size: 12px;
}
caption,
th,
td {
	font-weight: normal;
/*	text-align: center; 
	padding: 1;*/
	height: 0;
}
tr:first-child td{
	font-weight: bold;
	background-color: #84dbf5;
}
tr:nth-child(even) {
/*	background-color: #f2f2f2;*/
}
/* Adding following code on 24-Mar-2022 
table:not(.variations):not(.shop_table) {
  background: none;
}

table:not(.variations):not(.shop_table) tbody tr:nth-child(odd) {
  background-color: rgba(255,255,255,.15);
}
*/		</style>
		<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript><style>.ssBtnDefault{position:absolute;z-index:100000000;background:none;border:none;outline:none;right:0;cursor:pointer;width:26px;height:26px;margin:0;padding:0;top:8px;right:8px;opacity:.6;pointer-events:all;transition-duration:.25s}.ssBtnDefault:hover{opacity:1 !important;transition-duration:.25s}.ssBtnDefault .fade{transition-duration:5s;opacity:0}.ssBtnYouTube{background:none;border:none;margin-right:20px !important;padding-top:0px !important;width:25px !important}.ytp-embed .ssBtnYouTube{width:20px !important;margin-right:15px !important}.ssBtnVimeo{height:2rem !important;width:2rem !important;margin-top:8px !important}.ssBtnVimeo button{width:100% !important;height:100% !important}.ssBtnVimeo button svg{width:19px}.ssBtnNetflix{background:none;border:none;cursor:pointer;width:4rem;margin:0 .5rem;display:inline-block;flex-shrink:0}.ssBtnNetflix>svg{transform:translateY(-0.3rem)}.ssBtnNetflix:hover{transform:scale(1.2);transition-duration:.25s}.ssBtnHulu{width:27px;margin-top:4px;margin-right:10px;opacity:.7;cursor:pointer}.ssBtnHulu:hover{opacity:1}.ssBtnAmazon{margin-right:1.5vw;outline:none;cursor:pointer;opacity:.8}.ssBtnAmazon:hover{opacity:1}@media(min-width: 1200px){.ssBtnAmazon{width:1.6666666667vw;height:1.6666666667vw}}@media(max-width: 1199px){.ssBtnAmazon{width:20px;height:20px}}.ssBtnHBO{width:48px;height:48px;position:relative;opacity:.7;cursor:pointer;display:flex;justify-content:center;align-items:center}.ssBtnHBO:hover{opacity:1;transform:scale(1.2)}.ssBtnHBO svg{width:24px;height:24px}.ssBtnDisney{opacity:.7}.ssBtnDisney:hover{opacity:1}.ssBtnDisney svg{width:25px !important;height:31px !important;padding-top:4px;margin-right:7px}.ssBtnApple{cursor:pointer;opacity:.7}.ssBtnApple:hover{opacity:1}.ssBtnApple svg{width:22px !important;height:22px !important;margin-right:2px !important}body #ssTempHolder{position:fixed;z-index:1000000000000;width:100%;height:100%;top:0;pointer-events:none}body #ssTempHolder video{width:auto !important;height:auto !important;max-width:100% !important;max-height:100% !important;top:0 !important;left:0 !important;transform:none !important}body.ssTakeScreenshot .ssElement{z-index:100000000000 !important}body.ssTakeScreenshot.ssNetflix [data-uia=video-canvas]{z-index:10000000}body.ssTakeScreenshot.ssNetflix video{background-color:#000}body.ssTakeScreenshot.ssNetflix .player-timedtext{display:none !important}body.ssTakeScreenshot.ssNetflix.showSubs .player-timedtext{display:block !important}body.ssTakeScreenshot.ssAmazon .scalingVideoContainer{z-index:99999999 !important}body.ssTakeScreenshot.ssDisney .btm-media-overlays-container{display:none}body.ssTakeScreenshot.ssDisney .dss-hls-subtitle-overlay{display:none}body.ssTakeScreenshot.ssDisney.showSubs .dss-hls-subtitle-overlay{display:block}body.ssTakeScreenshot.ssHulu .ContentPlayer__contentArea{z-index:10000000000;position:relative}body.ssTakeScreenshot.ssHulu .ClosedCaption{display:none}body.ssTakeScreenshot.ssHulu.showSubs .ClosedCaption{display:block}body.ssTakeScreenshot.ssHulu.showSubs .ClosedCaption .ClosedCaption__outband{bottom:30px !important}body.ssTakeScreenshot.ssHBO video{z-index:99999999}body.ssTakeScreenshot.ssHBO *:has(video){z-index:99999999}body.ssTakeScreenshot.ssYoutube .html5-video-container,body.ssTakeScreenshot.ssYoutube .ytp-caption-window-container{z-index:999999999 !important}body.ssTakeScreenshot.ssApple #apple-music-video-player{z-index:999999999 !important}body.ssTakeScreenshot.ssApple .scrim{display:none}body .ssWrapper{overflow:hidden}body .ssNotification{display:flex;width:100%;height:4rem;justify-content:center;align-items:center;position:fixed;z-index:1000000000;top:-4rem;animation-name:notification;animation-duration:2s;animation-iteration-count:1}@keyframes notification{0%{top:-4rem}25%{top:3rem}85%{top:3rem}}body .ssNotification .ssNContent{position:absolute;z-index:1000000000;padding:.75rem 1.25em;margin-bottom:1em;border:1px solid rgba(0,0,0,0);border-radius:.25em;font-size:12px;height:fit-content;top:0}body .ssNotification .ssNContent.success{background-color:#d4edda;border-color:#c3e6cb;color:#155724}body .ssNotification .ssNContent.fail{background-color:#edd4d4;border-color:#e6c3c3;color:#b62424}body .ssModal{display:none;position:fixed;z-index:100000000;right:20px;opacity:0;background-color:#fffefa;border-radius:3px;padding:25px;color:#525252;font-family:muli,sans-serif;box-shadow:0px 4px 8px 0px rgba(0,0,0,.15);animation-name:animateOn;animation-duration:.2s;animation-fill-mode:forwards}body .ssModal.visible{display:block}body .ssModal *{vertical-align:middle;line-height:normal;font-weight:normal}@keyframes animateOn{from{opacity:0;top:0px}to{opacity:1;top:20px}}body .ssModal .close{position:absolute;right:10px;top:10px;cursor:pointer;opacity:.5;background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI3LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA0NDMuNCA0NDMuNCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDQzLjQgNDQzLjQ7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHBhdGggZD0iTTYuOCw0MDMuNWwxODEuOC0xODEuOEw2LjgsMzkuOWMtNS45LTUuOS04LjItMTQuNS02LTIyLjZDMyw5LjIsOS4yLDMsMTcuMywwLjhjOC4xLTIuMiwxNi43LDAuMSwyMi42LDZsMTgxLjgsMTgxLjgKCUw0MDMuNSw2LjhjNS45LTUuOSwxNC41LTguMiwyMi42LTZjOC4xLDIuMiwxNC40LDguNCwxNi41LDE2LjVjMi4yLDguMS0wLjEsMTYuNy02LDIyLjZMMjU0LjcsMjIxLjdsMTgxLjgsMTgxLjgKCWM1LjksNS45LDguMiwxNC41LDYsMjIuNmMtMi4yLDguMS04LjQsMTQuNC0xNi41LDE2LjVjLTguMSwyLjItMTYuNy0wLjEtMjIuNi02TDIyMS43LDI1NC43TDM5LjksNDM2LjVjLTUuOSw1LjktMTQuNSw4LjItMjIuNiw2CglDOS4yLDQ0MC40LDMsNDM0LjEsMC44LDQyNkMtMS40LDQxOCwwLjksNDA5LjQsNi44LDQwMy41TDYuOCw0MDMuNXoiLz4KPC9zdmc+Cg==);width:10px;height:10px}body .ssModal .ssButtons{margin-top:25px;text-align:right}body .ssModal .ssButtons .ssButton,body .ssModal .ssButtons a .ssButton{display:inline-block;height:20px;padding:3px 12px 3px;margin-left:14px;border-radius:4px;box-shadow:0px 4px 8px 0px rgba(0,0,0,.15);background-color:#fff;font-size:12px;color:#525252;line-height:20px;font-weight:normal;cursor:pointer;text-decoration:none}body .ssModal .ssButtons .ssButton .emoji,body .ssModal .ssButtons a .ssButton .emoji{font-size:15px;vertical-align:bottom}body .ssModal .ssButtons .ssButton.blue,body .ssModal .ssButtons a .ssButton.blue{background-color:#19acef;color:#fff}body .ssModal .icon{background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDI1LjIuMywgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIKCSBpZD0iTGF5ZXJfMSIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCgkgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAxMDAgODMuOSIKCSBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxMDAgODMuOTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiMwMEFERUY7fQo8L3N0eWxlPgo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLC05NTIuMzYyMTgpIj4KCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0zNS42LDk1Mi40Yy0xLjMsMC0yLjQsMS0yLjksMS44bC01LjYsMTEuMUgxMWMtNiwwLTExLDUtMTEsMTF2NDljMCw2LDUsMTEsMTEsMTFoNzhjNiwwLDExLTUsMTEtMTF2LTQ5CgkJYzAtNi01LTExLTExLTExSDcyLjlsLTUuNi0xMS4xYy0wLjUtMS4xLTEuNi0xLjgtMi45LTEuOEwzNS42LDk1Mi40TDM1LjYsOTUyLjR6IE0zNy42LDk1OC44aDI1LjJsNS41LDExLjEKCQljMC41LDEuMSwxLjYsMS44LDIuOSwxLjhoMTguMWMyLjYsMCw0LjUsMS45LDQuNSw0LjV2NDljMCwyLjYtMS45LDQuNS00LjUsNC41SDExLjFjLTIuNiwwLTQuNS0xLjktNC41LTQuNXYtNDkKCQljMC0yLjYsMS45LTQuNSw0LjUtNC41aDE4LjFjMS4xLDAsMi40LTAuOCwyLjktMS44TDM3LjYsOTU4Ljh6IE01MC4yLDk3OS44Yy0xMS42LDAtMjEsOS40LTIxLDIxczkuNCwyMSwyMSwyMXMyMS05LjQsMjEtMjEKCQlTNjEuOCw5NzkuOCw1MC4yLDk3OS44eiBNNTAuMiw5ODYuMmM4LjEsMCwxNC41LDYuNSwxNC41LDE0LjVzLTYuNSwxNC41LTE0LjUsMTQuNXMtMTQuNS02LjUtMTQuNS0xNC41UzQyLjEsOTg2LjIsNTAuMiw5ODYuMnoiLz4KPC9nPgo8L3N2Zz4K);background-repeat:no-repeat;width:30px;height:30px;vertical-align:top;margin-right:22px;margin-top:2px;display:inline-block}body .ssModal .body{display:inline-block;width:315px}body .ssModal .body .title{font-size:15px;font-weight:600;margin-bottom:7px}body .ssModal .body .description{font-size:13px;font-weight:lighter}
/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Njc3MvU2NyZWVuc2hvdENvbnRyb2wvX2J1dHRvbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3Njc3MvU2NyZWVuc2hvdENvbnRyb2wuc2NzcyIsIndlYnBhY2s6Ly8uL3Njc3MvU2NyZWVuc2hvdENvbnRyb2wvX25vdGlmaWNhdGlvbnMuc2NzcyIsIndlYnBhY2s6Ly8uL3Njc3MvU2NyZWVuc2hvdENvbnRyb2wvX21vZGFsLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsY0FFQyxpQkFBQSxDQUNBLGlCQUFBLENBQ0EsZUFBQSxDQUNBLFdBQUEsQ0FDQSxZQUFBLENBQ0EsT0FBQSxDQUNBLGNBQUEsQ0FFQSxVQUFBLENBQ0EsV0FBQSxDQUNBLFFBQUEsQ0FDQSxTQUFBLENBQ0EsT0FBQSxDQUNBLFNBQUEsQ0FFQSxVQUFBLENBQ0Esa0JBQUEsQ0FFRyx3QkFBQSxDQUVBLG9CQUNJLG9CQUFBLENBQ0Esd0JBQUEsQ0FHSixvQkFDSSxzQkFBQSxDQUNBLFNBQUEsQ0FRUixjQUVDLGVBQUEsQ0FDQSxXQUFBLENBRUEsNEJBQUEsQ0FDRywwQkFBQSxDQUNBLHFCQUFBLENBRUgseUJBQ0MscUJBQUEsQ0FDQSw0QkFBQSxDQUlGLFlBRUMsc0JBQUEsQ0FDRyxxQkFBQSxDQUVBLHlCQUFBLENBRUgsbUJBRUMscUJBQUEsQ0FDQSxzQkFBQSxDQUVBLHVCQUNDLFVBQUEsQ0FNSCxjQUNDLGVBQUEsQ0FDQSxXQUFBLENBQ0EsY0FBQSxDQUVBLFVBQUEsQ0FFQSxjQUFBLENBR0Esb0JBQUEsQ0FDQSxhQUFBLENBVUEsa0JBRUMsNkJBQUEsQ0FJRSxvQkFDSSxvQkFBQSxDQUNILHdCQUFBLENBSUwsV0FFQyxVQUFBLENBQ0EsY0FBQSxDQUNBLGlCQUFBLENBQ0EsVUFBQSxDQUNBLGNBQUEsQ0FFQSxpQkFDQyxTQUFBLENBSUYsYUFDQyxrQkFBQSxDQUVBLFlBQUEsQ0FFRSxjQUFBLENBQ0EsVUFBQSxDQUlDLG1CQUNJLFNBQUEsQ0FJUiwwQkFBQSxhQUFBLG9CQUFBLENBQUEscUJBQUEsQ0FBQSxDQUNBLDBCQUFBLGFBQUEsVUFBQSxDQUFBLFdBQUEsQ0FBQSxDQUdBLFVBRUksVUFBQSxDQUNBLFdBQUEsQ0FDQSxpQkFBQSxDQUNBLFVBQUEsQ0FDQSxjQUFBLENBQ0EsWUFBQSxDQUNBLHNCQUFBLENBQ0Esa0JBQUEsQ0FFSCxnQkFDQyxTQUFBLENBQ0Esb0JBQUEsQ0FHRCxjQUNDLFVBQUEsQ0FDQSxXQUFBLENBSUYsYUFHSSxVQUFBLENBRUgsbUJBQ0MsU0FBQSxDQUdELGlCQUNDLHFCQUFBLENBQ0Esc0JBQUEsQ0FDQSxlQUFBLENBQ0EsZ0JBQUEsQ0FJRixZQUlDLGNBQUEsQ0FHRyxVQUFBLENBRUgsa0JBQ0MsU0FBQSxDQUdELGdCQUNDLHFCQUFBLENBQ0Esc0JBQUEsQ0FDQSwyQkFBQSxDQzNMRCxtQkFDQyxjQUFBLENBQ0EscUJBQUEsQ0FDQSxVQUFBLENBQ0EsV0FBQSxDQUNBLEtBQUEsQ0FDQSxtQkFBQSxDQUVBLHlCQUNDLHFCQUFBLENBQ0Esc0JBQUEsQ0FDQSx5QkFBQSxDQUNBLDBCQUFBLENBQ0EsZ0JBQUEsQ0FDQSxpQkFBQSxDQUNBLHlCQUFBLENBTUQsaUNBQ0MsK0JBQUEsQ0FLQSx3REFDQyxnQkFBQSxDQUdELHNDQUNDLHFCQUFBLENBSUQsa0RBRUMsdUJBQUEsQ0FLQSwyREFFQyx3QkFBQSxDQVFGLHNEQUNDLDJCQUFBLENBTUQsNkRBQ0MsWUFBQSxDQUdELHlEQUNDLFlBQUEsQ0FLQSxrRUFDQyxhQUFBLENBTUYseURBQ0MsbUJBQUEsQ0FDRyxpQkFBQSxDQUdKLDRDQUNDLFlBQUEsQ0FJQSxxREFDQyxhQUFBLENBRUEsNkVBQ0Msc0JBQUEsQ0FRSCxrQ0FDQyxnQkFBQSxDQUdELHlDQUNDLGdCQUFBLENBT0QscUhBQ0MsNEJBQUEsQ0FLRCx3REFDQyw0QkFBQSxDQUdELHFDQUNDLFlBQUEsQ0FLSCxnQkFDQyxlQUFBLENDcElGLHFCQUVJLFlBQUEsQ0FDQSxVQUFBLENBQ0EsV0FBQSxDQUNBLHNCQUFBLENBQ0Esa0JBQUEsQ0FDQSxjQUFBLENBQ0Esa0JBQUEsQ0FDQSxTQUFBLENBRUEsMkJBQUEsQ0FDQSxxQkFBQSxDQUNBLDJCQUFBLENBRUEsd0JBQ0ksR0FBQSxTQUFBLENBQ0EsSUFBQSxRQUFBLENBQ0EsSUFBQSxRQUFBLENBQUEsQ0FHSixpQ0FFSSxpQkFBQSxDQUNBLGtCQUFBLENBQ0EscUJBQUEsQ0FDQSxpQkFBQSxDQUNBLDhCQUFBLENBQ0EsbUJBQUEsQ0FDQSxjQUFBLENBQ0Esa0JBQUEsQ0FDQSxLQUFBLENBRUEseUNBQ0ksd0JBQUEsQ0FDQSxvQkFBQSxDQUNBLGFBQUEsQ0FHSixzQ0FDSSx3QkFBQSxDQUNBLG9CQUFBLENBQ0EsYUFBQSxDQzFDWixjQUVJLFlBQUEsQ0FNQSxjQUFBLENBQ0EsaUJBQUEsQ0FFQSxVQUFBLENBRUEsU0FBQSxDQUVBLHdCQUFBLENBQ0EsaUJBQUEsQ0FFQSxZQUFBLENBRUEsYUFBQSxDQUNBLDJCQUFBLENBUUEsMENBQUEsQ0FFQSx3QkFBQSxDQUNBLHNCQUFBLENBQ0EsNEJBQUEsQ0E3QkEsc0JBQ0ksYUFBQSxDQWtCSixnQkFDSSxxQkFBQSxDQUNBLGtCQUFBLENBQ0Esa0JBQUEsQ0FTSixxQkFDSSxLQUNJLFNBQUEsQ0FDQSxPQUFBLENBRUosR0FDSSxTQUFBLENBQ0EsUUFBQSxDQUFBLENBSVIscUJBQ0ksaUJBQUEsQ0FDQSxVQUFBLENBQ0EsUUFBQSxDQUNBLGNBQUEsQ0FDQSxVQUFBLENBRUEsd0RBQUEsQ0FFQSxVQUFBLENBQ0EsV0FBQSxDQUlKLHlCQUVJLGVBQUEsQ0FDQSxnQkFBQSxDQUVBLHdFQUNJLG9CQUFBLENBRUEsV0FBQSxDQUVBLG9CQUFBLENBQ0EsZ0JBQUEsQ0FFQSxpQkFBQSxDQUNBLDBDQUFBLENBQ0EscUJBQUEsQ0FFQSxjQUFBLENBQ0EsYUFBQSxDQUNBLGdCQUFBLENBQ0Esa0JBQUEsQ0FFQSxjQUFBLENBRUEsb0JBQUEsQ0FFQSxzRkFDSSxjQUFBLENBQ0EscUJBQUEsQ0FHSixrRkFDSSx3QkFBQSxDQUNBLFVBQUEsQ0FLWixvQkFDSSx3REFBQSxDQUNBLDJCQUFBLENBRUEsVUFBQSxDQUNBLFdBQUEsQ0FFQSxrQkFBQSxDQUNBLGlCQUFBLENBQ0EsY0FBQSxDQUVBLG9CQUFBLENBR0osb0JBRUksb0JBQUEsQ0FDQSxXQUFBLENBRUEsMkJBQ0ksY0FBQSxDQUNBLGVBQUEsQ0FDQSxpQkFBQSxDQUVKLGlDQUNJLGNBQUEsQ0FDQSxtQkFBQSIsInNvdXJjZXNDb250ZW50IjpbIi5zc0J0bkRlZmF1bHQge1xuXHRcblx0cG9zaXRpb246IGFic29sdXRlO1xuXHR6LWluZGV4OiAxMDAwMDAwMDA7XG5cdGJhY2tncm91bmQ6bm9uZTtcblx0Ym9yZGVyOiBub25lO1xuXHRvdXRsaW5lOiBub25lO1xuXHRyaWdodDowO1xuXHRjdXJzb3I6IHBvaW50ZXI7XG5cdFxuXHR3aWR0aDogMjZweDtcblx0aGVpZ2h0OiAyNnB4O1xuXHRtYXJnaW46IDA7Ly81JSA4cHggMDtcblx0cGFkZGluZzowO1xuXHR0b3A6OHB4O1xuXHRyaWdodDo4cHg7XG5cdFxuXHRvcGFjaXR5OiAuNjtcblx0cG9pbnRlci1ldmVudHM6IGFsbDtcblx0Lyp0cmFuc2l0aW9uLWZpbGwtbW9kZTogZm9yd2FyZHM7Ki9cbiAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiAuMjVzO1xuXG4gICAgJjpob3ZlciB7XG4gICAgICAgIG9wYWNpdHk6IDEgIWltcG9ydGFudDsgXG4gICAgICAgIHRyYW5zaXRpb24tZHVyYXRpb246IC4yNXM7XG4gICAgfVxuXG4gICAgLmZhZGUge1xuICAgICAgICB0cmFuc2l0aW9uLWR1cmF0aW9uOiA1cztcbiAgICAgICAgb3BhY2l0eTogMDtcbiAgICB9XG4gICAgXG4gICAgLypzdmcge1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOnJlZDtcbiAgICB9Ki9cbn1cblxuLnNzQnRuWW91VHViZSB7XG5cblx0YmFja2dyb3VuZDpub25lO1xuXHRib3JkZXI6IG5vbmU7XG5cdFxuXHRtYXJnaW4tcmlnaHQ6IDIwcHggIWltcG9ydGFudDtcbiAgICBwYWRkaW5nLXRvcDogMHB4ICFpbXBvcnRhbnQ7XG4gICAgd2lkdGg6IDI1cHggIWltcG9ydGFudDtcblxuXHQueXRwLWVtYmVkICYge1xuXHRcdHdpZHRoOiAyMHB4ICFpbXBvcnRhbnQ7XG5cdFx0bWFyZ2luLXJpZ2h0OiAxNXB4ICFpbXBvcnRhbnQ7XG5cdH1cbn1cblxuLnNzQnRuVmltZW8ge1xuXG5cdGhlaWdodDogMnJlbSAhaW1wb3J0YW50O1xuICAgIHdpZHRoOiAycmVtICFpbXBvcnRhbnQ7XG4gICAgLy9wYWRkaW5nOiA2cHggIWltcG9ydGFudDtcbiAgICBtYXJnaW4tdG9wOiA4cHggIWltcG9ydGFudDtcblxuXHRidXR0b24ge1xuXG5cdFx0d2lkdGg6IDEwMCUgIWltcG9ydGFudDtcblx0XHRoZWlnaHQ6IDEwMCUgIWltcG9ydGFudDtcblx0XHRcblx0XHRzdmcge1xuXHRcdFx0d2lkdGg6IDE5cHg7XG5cdFx0fVxuXHR9XG5cbn1cblxuLnNzQnRuTmV0ZmxpeCB7XG5cdGJhY2tncm91bmQ6bm9uZTtcblx0Ym9yZGVyOiBub25lO1xuXHRjdXJzb3I6IHBvaW50ZXI7XG5cblx0d2lkdGg6NHJlbTtcblx0XG5cdG1hcmdpbjogMCAwLjVyZW07XG5cdC8vbWFyZ2luOiAwIDJyZW0gMCA0cmVtO1xuXG5cdGRpc3BsYXk6aW5saW5lLWJsb2NrO1xuXHRmbGV4LXNocmluazogMDtcblx0XG5cdC8vbWFyZ2luLXRvcDotMXJlbTtcblx0Ly9oZWlnaHQ6Mi40cmVtO1xuXHQvL3dpZHRoOiA1MHB4O1xuXHQvL2hlaWdodDogMzVweCAhaW1wb3J0YW50O1xuXHQvL3dpZHRoOiAxMDAlOy8vMy42ZW0gIWltcG9ydGFudDtcbiAgICAvL2hlaWdodDogMTAwJTsvLzEuNmVtICFpbXBvcnRhbnQ7XG5cdC8vcGFkZGluZzowIDAgLjZlbSAwO1xuXG5cdCYgPiBzdmcge1xuXHRcdC8vbWFyZ2luLXRvcDotLjNyZW07XG5cdFx0dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLS4zcmVtKTtcblx0XHQvL3RyYW5zZm9ybTogc2NhbGUoLjUpO1xuXHR9XG4gICAgXG4gICAgJjpob3ZlciB7XG4gICAgICAgIHRyYW5zZm9ybTpzY2FsZSgxLjIpO1xuXHQgICAgdHJhbnNpdGlvbi1kdXJhdGlvbjogLjI1cztcbiAgICB9XG59XG5cbi5zc0J0bkh1bHUge1xuXHRcblx0d2lkdGg6IDI3cHg7XG5cdG1hcmdpbi10b3A6IDRweDtcblx0bWFyZ2luLXJpZ2h0OjEwcHg7XG5cdG9wYWNpdHk6IC43O1xuXHRjdXJzb3I6IHBvaW50ZXI7XG5cdFxuXHQmOmhvdmVyIHtcblx0XHRvcGFjaXR5OiAxO1xuXHR9XG59XG5cbi5zc0J0bkFtYXpvbiB7XG5cdG1hcmdpbi1yaWdodDogMS41dnc7XG4gICAgXG5cdG91dGxpbmU6IG5vbmU7XG5cdFxuICAgY3Vyc29yOiBwb2ludGVyO1xuICAgb3BhY2l0eTogLjg7XG5cbiAgIC8vei1pbmRleDogOTk5OTk5OTk5OTtcblxuICAgICY6aG92ZXIge1xuICAgICAgICBvcGFjaXR5OiAxO1xuICAgIH1cbn1cblxuQG1lZGlhIChtaW4td2lkdGg6IDEyMDBweCkgeyAuc3NCdG5BbWF6b24geyB3aWR0aDogMS42NjY2NjY2NjY2NjY2NjY1dnc7IGhlaWdodDogMS42NjY2NjY2NjY2NjY2NjY1dnc7IH0gfVxuQG1lZGlhIChtYXgtd2lkdGg6IDExOTlweCkgeyAuc3NCdG5BbWF6b24geyB3aWR0aDogMjBweDsgaGVpZ2h0OiAyMHB4OyB9IH1cblxuXG4uc3NCdG5IQk8ge1xuXG4gICAgd2lkdGg6IDQ4cHg7XG4gICAgaGVpZ2h0OiA0OHB4O1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICBvcGFjaXR5OiAwLjc7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcblxuXHQmOmhvdmVyIHtcblx0XHRvcGFjaXR5OiAxO1xuXHRcdHRyYW5zZm9ybTogc2NhbGUoMS4yKTtcblx0fVxuXG5cdHN2ZyB7XG5cdFx0d2lkdGg6IDI0cHg7XG5cdFx0aGVpZ2h0OiAyNHB4O1xuXHR9XG59XG5cbi5zc0J0bkRpc25leSB7XG5cdC8vd2lkdGg6IDI2cHg7XG4gICAgLy9tYXJnaW4tcmlnaHQ6IDEzcHg7XG4gICAgb3BhY2l0eTogLjc7XG5cblx0Jjpob3ZlciB7XG5cdFx0b3BhY2l0eTogMTtcblx0fVxuXG5cdHN2ZyB7XG5cdFx0d2lkdGg6IDI1cHggIWltcG9ydGFudDtcblx0XHRoZWlnaHQ6IDMxcHggIWltcG9ydGFudDtcblx0XHRwYWRkaW5nLXRvcDogNHB4O1xuXHRcdG1hcmdpbi1yaWdodDogN3B4O1xuXHR9XG59XG5cbi5zc0J0bkFwcGxlIHtcblx0Ly93aWR0aDogMjZweDtcbiAgICAvL21hcmdpbi1yaWdodDogMTNweDtcblxuXHRjdXJzb3I6IHBvaW50ZXI7XG5cblxuICAgIG9wYWNpdHk6IC43O1xuXG5cdCY6aG92ZXIge1xuXHRcdG9wYWNpdHk6IDE7XG5cdH1cblxuXHRzdmcge1xuXHRcdHdpZHRoOiAyMnB4ICFpbXBvcnRhbnQ7XG5cdFx0aGVpZ2h0OiAyMnB4ICFpbXBvcnRhbnQ7XG5cdFx0bWFyZ2luLXJpZ2h0OiAycHggIWltcG9ydGFudDtcblx0fVxufSIsIkBpbXBvcnQgXCJTY3JlZW5zaG90Q29udHJvbC9idXR0b25zXCI7XG5cbmJvZHkge1xuXG5cdCNzc1RlbXBIb2xkZXIge1xuXHRcdHBvc2l0aW9uOmZpeGVkO1xuXHRcdHotaW5kZXg6MTAwMDAwMDAwMDAwMDtcblx0XHR3aWR0aDoxMDAlO1xuXHRcdGhlaWdodDoxMDAlO1xuXHRcdHRvcDowO1xuXHRcdHBvaW50ZXItZXZlbnRzOiBub25lO1xuXG5cdFx0dmlkZW8ge1xuXHRcdFx0d2lkdGg6YXV0byAhaW1wb3J0YW50O1xuXHRcdFx0aGVpZ2h0OmF1dG8gIWltcG9ydGFudDtcblx0XHRcdG1heC13aWR0aDoxMDAlICFpbXBvcnRhbnQ7XG5cdFx0XHRtYXgtaGVpZ2h0OiAxMDAlICFpbXBvcnRhbnQ7XG5cdFx0XHR0b3A6IDAgIWltcG9ydGFudDtcblx0XHRcdGxlZnQ6IDAgIWltcG9ydGFudDtcblx0XHRcdHRyYW5zZm9ybTogbm9uZSAhaW1wb3J0YW50O1xuXHRcdH1cblx0fVxuXG5cdCYuc3NUYWtlU2NyZWVuc2hvdCB7XG5cdFx0XG5cdFx0LnNzRWxlbWVudCB7XG5cdFx0XHR6LWluZGV4OiAxMDAwMDAwMDAwMDAgIWltcG9ydGFudDtcblx0XHR9XG5cdFx0XG5cdFx0Ji5zc05ldGZsaXgge1xuXHRcblx0XHRcdFtkYXRhLXVpYT12aWRlby1jYW52YXNdIHtcblx0XHRcdFx0ei1pbmRleDogMTAwMDAwMDA7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHZpZGVvIHtcblx0XHRcdFx0YmFja2dyb3VuZC1jb2xvcjogIzAwMDAwMDtcblx0XHRcdFx0Ly9oZWlnaHQ6IGF1dG8gIWltcG9ydGFudDtcblx0XHRcdH1cblxuXHRcdFx0LnBsYXllci10aW1lZHRleHQge1xuXG5cdFx0XHRcdGRpc3BsYXk6bm9uZSAhaW1wb3J0YW50O1xuXHRcdFx0fVx0XHRcdFxuXG5cdFx0XHQmLnNob3dTdWJzIHtcblx0XHRcdFx0XG5cdFx0XHRcdC5wbGF5ZXItdGltZWR0ZXh0IHtcblxuXHRcdFx0XHRcdGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7XG5cdFx0XHRcdFx0Ly9ib3R0b206IDEwJSAhaW1wb3J0YW50O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ji5zc0FtYXpvbiB7XG5cblx0XHRcdC5zY2FsaW5nVmlkZW9Db250YWluZXIge1xuXHRcdFx0XHR6LWluZGV4OiA5OTk5OTk5OSAhaW1wb3J0YW50O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdCYuc3NEaXNuZXkge1xuXG5cdFx0XHQuYnRtLW1lZGlhLW92ZXJsYXlzLWNvbnRhaW5lciB7XG5cdFx0XHRcdGRpc3BsYXk6bm9uZTtcblx0XHRcdH1cblxuXHRcdFx0LmRzcy1obHMtc3VidGl0bGUtb3ZlcmxheSB7XG5cdFx0XHRcdGRpc3BsYXk6IG5vbmU7XG5cdFx0XHR9XG5cblx0XHRcdCYuc2hvd1N1YnMge1xuXHRcdFx0XHRcblx0XHRcdFx0LmRzcy1obHMtc3VidGl0bGUtb3ZlcmxheSB7XG5cdFx0XHRcdFx0ZGlzcGxheTogYmxvY2s7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQmLnNzSHVsdSB7XG5cdFx0XHQuQ29udGVudFBsYXllcl9fY29udGVudEFyZWEge1xuXHRcdFx0XHR6LWluZGV4OiAxMDAwMDAwMDAwMDtcbiAgICBcdFx0XHRwb3NpdGlvbjogcmVsYXRpdmU7XG5cdFx0XHR9XG5cblx0XHRcdC5DbG9zZWRDYXB0aW9uIHtcblx0XHRcdFx0ZGlzcGxheTpub25lO1xuXHRcdFx0fVxuXG5cdFx0XHQmLnNob3dTdWJzIHtcblx0XHRcdFx0LkNsb3NlZENhcHRpb24ge1xuXHRcdFx0XHRcdGRpc3BsYXk6YmxvY2s7XG5cblx0XHRcdFx0XHQuQ2xvc2VkQ2FwdGlvbl9fb3V0YmFuZCB7XG5cdFx0XHRcdFx0XHRib3R0b206IDMwcHggIWltcG9ydGFudDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQmLnNzSEJPIHtcblxuXHRcdFx0dmlkZW8ge1xuXHRcdFx0XHR6LWluZGV4OiA5OTk5OTk5OTtcblx0XHRcdH1cblxuXHRcdFx0KjpoYXModmlkZW8pIHtcblx0XHRcdFx0ei1pbmRleDogOTk5OTk5OTk7XG5cdFx0XHR9XG5cblx0XHR9XG5cblx0XHQmLnNzWW91dHViZSB7XG5cblx0XHRcdC5odG1sNS12aWRlby1jb250YWluZXIsIC55dHAtY2FwdGlvbi13aW5kb3ctY29udGFpbmVyIHtcblx0XHRcdFx0ei1pbmRleDogOTk5OTk5OTk5ICFpbXBvcnRhbnQ7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ji5zc0FwcGxlIHtcblx0XHRcdCNhcHBsZS1tdXNpYy12aWRlby1wbGF5ZXIge1xuXHRcdFx0XHR6LWluZGV4OiA5OTk5OTk5OTkgIWltcG9ydGFudDtcblx0XHRcdH1cblxuXHRcdFx0LnNjcmltIHtcblx0XHRcdFx0ZGlzcGxheTpub25lO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC5zc1dyYXBwZXIge1xuXHRcdG92ZXJmbG93OiBoaWRkZW47XG5cdH1cblxuXHRAaW1wb3J0IFwiU2NyZWVuc2hvdENvbnRyb2wvbm90aWZpY2F0aW9uc1wiO1xuXHRAaW1wb3J0IFwiU2NyZWVuc2hvdENvbnRyb2wvbW9kYWxcIjtcbn0iLCIuc3NOb3RpZmljYXRpb24ge1xuXG4gICAgZGlzcGxheTogZmxleDtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBoZWlnaHQ6IDRyZW07XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgei1pbmRleDogMTAwMDAwMDAwMDtcbiAgICB0b3A6LTRyZW07XG5cbiAgICBhbmltYXRpb24tbmFtZTogbm90aWZpY2F0aW9uO1xuICAgIGFuaW1hdGlvbi1kdXJhdGlvbjogMnM7XG4gICAgYW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudDogMTtcblxuICAgIEBrZXlmcmFtZXMgbm90aWZpY2F0aW9uIHtcbiAgICAgICAgMCUge3RvcDogLTRyZW07fVxuICAgICAgICAyNSUge3RvcDogM3JlbTt9XG4gICAgICAgIDg1JSB7dG9wOiAzcmVtO31cbiAgICB9XG5cbiAgICAuc3NOQ29udGVudCB7XG4gICAgICAgIC8vY29udGVudDogJ1NjcmVlbnNob3QgY29waWVkIHRvIGNsaXBib2FyZCEnO1xuICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgIHotaW5kZXg6IDEwMDAwMDAwMDA7XG4gICAgICAgIHBhZGRpbmc6IC43NXJlbSAxLjI1ZW07XG4gICAgICAgIG1hcmdpbi1ib3R0b206IDFlbTtcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdHJhbnNwYXJlbnQ7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IC4yNWVtO1xuICAgICAgICBmb250LXNpemU6IDEycHg7XG4gICAgICAgIGhlaWdodDogZml0LWNvbnRlbnQ7XG4gICAgICAgIHRvcDowO1xuXG4gICAgICAgICYuc3VjY2VzcyB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDRlZGRhO1xuICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiAjYzNlNmNiO1xuICAgICAgICAgICAgY29sb3I6ICMxNTU3MjQ7XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgJi5mYWlsIHtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNlZGQ0ZDQ7XG4gICAgICAgICAgICBib3JkZXItY29sb3I6ICNlNmMzYzM7XG4gICAgICAgICAgICBjb2xvcjogI2I2MjQyNDtcbiAgICAgICAgfVxuICAgIH1cblxufSIsIi5zc01vZGFsIHtcblxuICAgIGRpc3BsYXk6IG5vbmU7XG5cbiAgICAmLnZpc2libGUge1xuICAgICAgICBkaXNwbGF5OmJsb2NrO1xuICAgIH1cblxuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB6LWluZGV4OiAxMDAwMDAwMDA7XG5cbiAgICByaWdodDoyMHB4O1xuICAgIFxuICAgIG9wYWNpdHk6IDA7XG5cbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiNmZmZlZmE7XG4gICAgYm9yZGVyLXJhZGl1czogM3B4O1xuXG4gICAgcGFkZGluZzogMjVweDtcblxuICAgIGNvbG9yOiAjNTI1MjUyO1xuICAgIGZvbnQtZmFtaWx5OiBtdWxpLCBzYW5zLXNlcmlmO1xuICAgIFxuICAgICoge1xuICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICAgICAgICBsaW5lLWhlaWdodDogbm9ybWFsO1xuICAgICAgICBmb250LXdlaWdodDogbm9ybWFsO1xuICAgIH1cblxuICAgIGJveC1zaGFkb3c6IDBweCA0cHggOHB4IDBweCByZ2JhKDAsIDAsIDAsIDAuMTUpO1xuXG4gICAgYW5pbWF0aW9uLW5hbWU6IGFuaW1hdGVPbjtcbiAgICBhbmltYXRpb24tZHVyYXRpb246IC4ycztcbiAgICBhbmltYXRpb24tZmlsbC1tb2RlOiBmb3J3YXJkcztcblxuICAgIEBrZXlmcmFtZXMgYW5pbWF0ZU9uIHtcbiAgICAgICAgZnJvbSB7XG4gICAgICAgICAgICBvcGFjaXR5OiAwO1xuICAgICAgICAgICAgdG9wOiAwcHg7XG4gICAgICAgIH1cbiAgICAgICAgdG8ge1xuICAgICAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgICAgICAgIHRvcDogMjBweDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC5jbG9zZSB7XG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgcmlnaHQ6IDEwcHg7XG4gICAgICAgIHRvcDogMTBweDtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBvcGFjaXR5OiAuNTtcblxuICAgICAgICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJy4uL2ltYWdlcy9jbG9zZS5zdmcnKTtcblxuICAgICAgICB3aWR0aDoxMHB4O1xuICAgICAgICBoZWlnaHQ6MTBweDtcblxuICAgIH1cblxuICAgIC5zc0J1dHRvbnMge1xuXG4gICAgICAgIG1hcmdpbi10b3A6IDI1cHg7XG4gICAgICAgIHRleHQtYWxpZ246IHJpZ2h0O1xuXG4gICAgICAgIC5zc0J1dHRvbiwgYSAuc3NCdXR0b24ge1xuICAgICAgICAgICAgZGlzcGxheTppbmxpbmUtYmxvY2s7XG5cbiAgICAgICAgICAgIGhlaWdodDoyMHB4O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBwYWRkaW5nOjNweCAxMnB4IDNweDtcbiAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiAxNHB4O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAwcHggNHB4IDhweCAwcHggcmdiYSgwLCAwLCAwLCAwLjE1KTtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkZGRkY7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDtcbiAgICAgICAgICAgIGNvbG9yOiAjNTI1MjUyO1xuICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDIwcHg7XG4gICAgICAgICAgICBmb250LXdlaWdodDogbm9ybWFsO1xuICAgIFxuICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuXG4gICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG5cbiAgICAgICAgICAgIC5lbW9qaSB7XG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAxNXB4O1xuICAgICAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG4gICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAmLmJsdWUge1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMxOWFjZWY7XG4gICAgICAgICAgICAgICAgY29sb3I6ICNGRkZGRkY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAuaWNvbiB7XG4gICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnLi4vaW1hZ2VzL2ljb25CbHVlLnN2ZycpO1xuICAgICAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuXG4gICAgICAgIHdpZHRoOjMwcHg7XG4gICAgICAgIGhlaWdodDozMHB4O1xuXG4gICAgICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7XG4gICAgICAgIG1hcmdpbi1yaWdodDogMjJweDtcbiAgICAgICAgbWFyZ2luLXRvcDoycHg7XG5cbiAgICAgICAgZGlzcGxheTppbmxpbmUtYmxvY2s7XG4gICAgfVxuXG4gICAgLmJvZHkge1xuXG4gICAgICAgIGRpc3BsYXk6aW5saW5lLWJsb2NrO1xuICAgICAgICB3aWR0aDozMTVweDtcblxuICAgICAgICAudGl0bGUge1xuICAgICAgICAgICAgZm9udC1zaXplOiAxNXB4O1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDdweDtcbiAgICAgICAgfVxuICAgICAgICAuZGVzY3JpcHRpb24ge1xuICAgICAgICAgICAgZm9udC1zaXplOiAxM3B4O1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGxpZ2h0ZXI7XG4gICAgICAgIH1cbiAgICB9XG5cbn0iXSwic291cmNlUm9vdCI6IiJ9 */</style><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="AlK2UR5SkAlj8jjdEc9p3F3xuFYlF6LYjAML3EOqw1g26eCwWPjdmecULvBH5MVPoqKYrOfPhYVL71xAXI1IBQoAAAB8eyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="Amm8/NmvvQfhwCib6I7ZsmUxiSCfOxWxHayJwyU1r3gRIItzr7bNQid6O8ZYaE1GSQTa69WwhPC9flq/oYkRBwsAAACCeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiV2ViVmlld1hSZXF1ZXN0ZWRXaXRoRGVwcmVjYXRpb24iLCJleHBpcnkiOjE3NTgwNjcxOTksImlzU3ViZG9tYWluIjp0cnVlfQ=="><meta http-equiv="origin-trial" content="A/ERL66fN363FkXxgDc6F1+ucRUkAhjEca9W3la6xaLnD2Y1lABsqmdaJmPNaUKPKVBRpyMKEhXYl7rSvrQw+AkAAACNeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><meta http-equiv="origin-trial" content="A6OdGH3fVf4eKRDbXb4thXA4InNqDJDRhZ8U533U/roYjp4Yau0T3YSuc63vmAs/8ga1cD0E3A7LEq6AXk1uXgsAAACTeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiRmxlZGdlQmlkZGluZ0FuZEF1Y3Rpb25TZXJ2ZXIiLCJleHBpcnkiOjE3MTkzNTk5OTksImlzU3ViZG9tYWluIjp0cnVlLCJpc1RoaXJkUGFydHkiOnRydWV9"><script async="" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/ca-pub-9040638560872555"></script><script async="" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/AGSKWxUlTnfBX4XeHlT-aT6mkVXRUn64Z0wX5Qs_3ZS4-i6Mi6vqUJzIvoWVI0PASZcszfgD3eviTPUQCopDkNbLPw_b-mCTjv_-7_DX6-8JQAcOt3mVeh2-fN7wXCMo2eKnDO96Fzjfng=="></script><script async="" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/AGSKWxUIp2q0r7pN0nfGxAFtY7a-q1Wjsj8GqD7spnn-Ol1cHhBfscO3a0PsH8JK2B2Ua89by1a_8pTE1Jbl-iRp66S2HRntlfaV41mmeF4Wgs2AqwmeaGgpqU5Mi76oqJ72H2ba2L3x6A=="></script><script async="" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/AGSKWxVPqWSmbktOAQt7MWJV-3RU-C_-qgHsLvNgGzDtu1iNoJpZljMHkpp-nJAzPGz7EZoYNa3tKbjKkKKUscSS6MxD8JAlVvR_C5fNYhBgeANF2Gm_lvRBLhUmOgwTCLkxsmWLXI21Hg=="></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/m=el_main_css"></head>

<body class="post-template-default single single-post postid-2305 single-format-standard wp-embed-responsive post-image-above-header post-image-aligned-center sticky-menu-slide sticky-enabled both-sticky-menu right-sidebar nav-below-header separate-containers fluid-header active-footer-widgets-3 nav-aligned-left header-aligned-left dropdown-hover using-mouse" itemtype="https://schema.org/Blog" itemscope="" style="padding: 0px 0px 154px;" cz-shortcut-listen="true">
	<a class="screen-reader-text skip-link" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#content" title="Aller au contenu"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aller au contenu</font></font></a>		<header class="site-header" id="masthead" aria-label="Site" itemtype="https://schema.org/WPHeader" itemscope="">
			<div class="inside-header grid-container grid-parent">
							<div class="header-widget">
				<aside id="search-2" class="widget inner-padding widget_search"><form method="get" class="search-form" action="https://dataforgeeks.com/" data-np-autofill-form-type="other" data-np-checked="1" data-np-watching="1">
	<label>
		<span class="screen-reader-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rechercher:</font></font></span>
		<input type="search" class="search-field" placeholder="Recherche …" value="" name="s" title="Rechercher:" data-np-intersection-state="visible">
	</label>
	<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><input type="submit" class="search-submit" value="Recherche"></font></font></form>
</aside>			</div>
			<div class="site-branding">
						<p class="main-title" itemprop="headline">
					<a href="https://dataforgeeks.com/" rel="home"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DataForGeeks</font></font></a>
				</p>
						<p class="site-description" itemprop="description"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pour les passionnés de données</font></font></p>
					</div>			</div>
		</header>
				<nav class="main-navigation sub-menu-right stuckElement is_stuck navigation-stick navigation-clone sticky-navigation-transition" id="sticky-navigation" aria-label="Primaire" itemtype="https://schema.org/SiteNavigationElement" itemscope="" style="z-index: 100; transform: translateY(0px); transition: transform 300ms ease-in-out 0s; margin-top: 0px; position: fixed; top: 0px;">
			<div class="inside-navigation grid-container grid-parent">
								<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
					<span class="mobile-menu"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menu</font></font></span>				</button>
				<div id="primary-menu" class="main-nav"><ul id="menu-main-menu" class=" menu sf-menu"><li id="menu-item-18" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-18"><a href="https://dataforgeeks.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maison</font></font></a></li>
<li id="menu-item-25" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-25"><a href="https://dataforgeeks.com/sql-problems/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problèmes SQL</font></font></a></li>
<li id="menu-item-13" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-13"><a href="https://dataforgeeks.com/contact-us/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contactez-nous</font></font></a></li>
</ul></div>			</div>
		</nav><nav class="main-navigation sub-menu-right is_stuck navigation-stick navigation-clone sticky-navigation-transition" id="sticky-placeholder" aria-label="Primaire" style="visibility: hidden;">
			<div class="inside-navigation grid-container grid-parent">
								<button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">
					<span class="mobile-menu"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menu</font></font></span>				</button>
				<div id="primary-menu" class="main-nav"><ul id="menu-main-menu" class=" menu sf-menu"><li id="menu-item-18" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-18"><a href="https://dataforgeeks.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maison</font></font></a></li>
<li id="menu-item-25" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-25"><a href="https://dataforgeeks.com/sql-problems/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problèmes SQL</font></font></a></li>
<li id="menu-item-13" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-13"><a href="https://dataforgeeks.com/contact-us/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contactez-nous</font></font></a></li>
</ul></div>			</div>
		</nav>
		
	<div class="site grid-container container hfeed grid-parent" id="page">
				<div class="site-content" id="content">
			
	<div class="content-area grid-parent mobile-grid-100 grid-75 tablet-grid-75" id="primary">
		<main class="site-main" id="main">
			
<article id="post-2305" class="post-2305 post type-post status-publish format-standard hentry category-general tag-apache-spark tag-big-data tag-bigdata tag-optimisation tag-partition tag-spark tag-tuning" itemtype="https://schema.org/CreativeWork" itemscope="">
	<div class="inside-article">
					<header class="entry-header">
				<h1 class="entry-title" itemprop="headline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apache Spark – Optimisation des performances et meilleures pratiques</font></font></h1>		<div class="entry-meta">
			<span class="posted-on"><time class="updated" datetime="2022-05-16T21:19:34+00:00" itemprop="dateModified"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 mai 2022</font></font></time><time class="entry-date published" datetime="2022-05-04T12:33:18+00:00" itemprop="datePublished"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 mai 2022</font></font></time></span> <span class="byline"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par </font></font><span class="author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope=""><a class="url fn n" href="https://dataforgeeks.com/author/nikhilaggarwal/" title="Afficher tous les articles de Nikhil Aggarwal" rel="author" itemprop="url"><span class="author-name" itemprop="name"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nikhil Aggarwal</font></font></span></a></span></span> 		</div>
					</header>
			
		<div class="entry-content" itemprop="text">
			
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque&nbsp;: Cet article est un effort de compilation de plusieurs méthodologies d'optimisation des performances dans Apache Spark. Le texte/les images de l'article suivant proviennent de divers articles et livres intéressants, dont les détails sont capturés sous «&nbsp;Références&nbsp;».</font></font></p>



<figure class="wp-block-image size-full"><img fetchpriority="high" decoding="async" width="800" height="405" alt="" class="wp-image-2419 entered exited" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image.jpg 800w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image-300x152.jpg 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image-768x389.jpg 768w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image.jpg" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20800%20405&#39;%3E%3C/svg%3E"><noscript><img fetchpriority="high" decoding="async" width="800" height="405" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image.jpg" alt="" class="wp-image-2419" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image.jpg 800w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image-300x152.jpg 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-1-tuning_spark_image-768x389.jpg 768w" sizes="(max-width: 800px) 100vw, 800px" /></noscript></figure>



<div id="ez-toc-container" class="ez-toc-v2_0_63 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction">
<p class="ez-toc-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table des matières</font></font></p>
<label for="ez-toc-cssicon-toggle-item-662d1fb96a58d" class="ez-toc-cssicon-toggle-label"><span class=""><span class="eztoc-hide" style="display:none;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basculer</font></font></span><span class="ez-toc-icon-toggle-span"><svg style="fill: #999;color:#999" xmlns="http://www.w3.org/2000/svg" class="list-377408" width="20px" height="20px" viewBox="0 0 24 24" fill="none"><path d="M6 6H4v2h2V6zm14 0H8v2h12V6zM4 11h2v2H4v-2zm16 0H8v2h12v-2zM4 16h2v2H4v-2zm16 0H8v2h12v-2z" fill="currentColor"></path></svg><svg style="fill: #999;color:#999" class="arrow-unsorted-368013" xmlns="http://www.w3.org/2000/svg" width="10px" height="10px" viewBox="0 0 24 24" version="1.2" baseProfile="tiny"><path d="M18.2 9.3l-6.2-6.3-6.2 6.3c-.2.2-.3.4-.3.7s.1.5.3.7c.2.2.4.3.7.3h11c.3 0 .5-.1.7-.3.2-.2.3-.5.3-.7s-.1-.5-.3-.7zM5.8 14.7l6.2 6.3 6.2-6.3c.2-.2.3-.5.3-.7s-.1-.5-.3-.7c-.2-.2-.4-.3-.7-.3h-11c-.3 0-.5.1-.7.3-.2.2-.3.5-.3.7s.1.5.3.7z"></path></svg></span></span></label><input type="checkbox" id="ez-toc-cssicon-toggle-item-662d1fb96a58d" aria-label="Basculer"><nav><ul class="ez-toc-list ez-toc-list-level-1 "><li class="ez-toc-page-1 ez-toc-heading-level-1"><a class="ez-toc-link ez-toc-heading-1" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Tweak_Configurations" title="Ajuster les configurations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajuster les configurations</font></font></a><ul class="ez-toc-list-level-2"><li class="ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-2" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Viewing_and_Setting_Apache_Spark_Configurations" title="Affichage et définition des configurations Apache Spark"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Affichage et définition des configurations Apache Spark</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-3" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Configuration_changes" title="Modifications de configuration"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifications de configuration</font></font></a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-4" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Static_vs_Dynamic_allocation" title="Allocation statique ou dynamique"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Allocation statique ou dynamique</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-5" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Spark_Executor_memory" title="Mémoire de l&#39;exécuteur Spark"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mémoire de l'exécuteur Spark</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-6" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Partition_size" title="Taille de la partition"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Taille de la partition</font></font></a></li></ul></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-1"><a class="ez-toc-link ez-toc-heading-7" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Minimise_Shuffle" title="Réduire la lecture aléatoire"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réduire la lecture aléatoire</font></font></a><ul class="ez-toc-list-level-2"><li class="ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-8" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Number_of_shuffle_partitions" title="Nombre de partitions aléatoires"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nombre de partitions aléatoires</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-9" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Shuffle_Service_internals" title="Mélanger les éléments internes du service"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mélanger les éléments internes du service</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-10" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Bucketing" title="Godage"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Godage</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-11" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Optimise_Joins" title="Optimiser les jointures"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optimiser les jointures</font></font></a><ul class="ez-toc-list-level-3"><li class="ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-12" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Shuffle_Hash_join" title="Rejoindre Shuffle Hash"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rejoindre Shuffle Hash</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-13" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Broadcast_Hash_joins" title="Broadcast Hash rejoint"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Broadcast Hash rejoint</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-3"><a class="ez-toc-link ez-toc-heading-14" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Shuffle_Sort_merge_join" title="Fusion de tri aléatoire"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fusion de tri aléatoire</font></font></a></li></ul></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-1"><a class="ez-toc-link ez-toc-heading-15" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Tackle_Skew_Data" title="S&#39;attaquer aux données asymétriques"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'attaquer aux données asymétriques</font></font></a><ul class="ez-toc-list-level-2"><li class="ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-16" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Salting" title="Salaison"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salaison</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-17" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Repartition" title="Répartition"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Répartition</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-18" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#AQE_Adaptive_Query_Execution" title="AQE (exécution adaptative de requêtes)"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AQE (exécution adaptative de requêtes)</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-19" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Iterative_broadcast_join" title="Jointure de diffusion itérative"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jointure de diffusion itérative</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-20" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Skew_hint" title="Indice de biais"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indice de biais</font></font></a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-1"><a class="ez-toc-link ez-toc-heading-21" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Cache_properly" title="Cacher correctement"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cacher correctement</font></font></a><ul class="ez-toc-list-level-2"><li class="ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-22" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Caching" title="Mise en cache"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise en cache</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-23" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Persistence" title="Persistance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Persistance</font></font></a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-1"><a class="ez-toc-link ez-toc-heading-24" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Best_Practices" title="Les meilleures pratiques"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les meilleures pratiques</font></font></a><ul class="ez-toc-list-level-2"><li class="ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-25" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Use_DataframeDataset_over_RDD" title="Utiliser Dataframe/Dataset sur RDD"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utiliser Dataframe/Dataset sur RDD</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-26" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Use_coalesce_over_repartition" title="Utilisez coalesce() sur repartition()"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisez coalesce() sur repartition()</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-27" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#use_mapPartitions_over_map" title="utilisez mapPartitions() sur map()"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisez mapPartitions() sur map()</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-28" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Avoid_UDFs" title="Évitez les FDU"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Évitez les FDU</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-29" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Disable_unnecessary_DEBUG_and_INFO_logging" title="Désactivez la journalisation DEBUG et INFO inutile"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Désactivez la journalisation DEBUG et INFO inutile</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-30" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Checkpointing" title="Points de contrôle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Points de contrôle</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-31" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Use_proper_file_formats" title="Utilisez les formats de fichiers appropriés"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisez les formats de fichiers appropriés</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-2"><a class="ez-toc-link ez-toc-heading-32" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#use_toPandas_with_pyArrow" title="utilisez toPandas() avec pyArrow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisez toPandas() avec pyArrow</font></font></a></li></ul></li><li class="ez-toc-page-1 ez-toc-heading-level-1"><a class="ez-toc-link ez-toc-heading-33" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#Takeaways" title="Points à retenir"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Points à retenir</font></font></a></li><li class="ez-toc-page-1 ez-toc-heading-level-1"><a class="ez-toc-link ez-toc-heading-34" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#References" title="Les références"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les références</font></font></a></li></ul></nav></div>
<h1 class="wp-block-heading"><span class="ez-toc-section" id="Tweak_Configurations"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajuster les configurations</font></font><span class="ez-toc-section-end"></span></h1>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Viewing_and_Setting_Apache_Spark_Configurations"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Affichage et définition des configurations Apache Spark</font></font><span class="ez-toc-section-end"></span></h2>



<p><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 façons de procéder :</font></font></strong></p>



<ol><li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voie 1&nbsp;:</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Utilisation </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">du répertoire $SPARK_HOME</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (les modifications de configuration dans le fichier conf/spark-defaults.conf s'appliquent au cluster Spark et à toutes les applications Spark soumises au cluster.) : </font></font><br><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf/spark-defaults.conf.template </font></font></em><br><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf/log4j. propriétés.template </font></font></em><br><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conf/spark-env.sh.template</font></font></em></li><li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voie 2&nbsp;:</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Spécifiez les configurations Spark directement dans votre application Spark ou sur la ligne de commande lors de la soumission de l'application avec </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark-submit, en utilisant l'indicateur –conf</font></font></strong><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ex&nbsp;: spark-submit –conf spark.sql.shuffle.partitions=5 –conf " spark.executor.memory=2g » –class main.scala.chapter7.SparkConfig_7_1 jars/main-scala-chapter7_2.12-1.0.jar</font></font></li><li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voie 3&nbsp;:</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La troisième option consiste à utiliser une </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interface de programmation via le shell Spark.</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Grâce à l'objet SparkSession, vous pouvez accéder à la plupart des paramètres de configuration Spark. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Remarque : Vérifiez d'abord si la propriété est modifiable. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.conf.isModifiable(“&lt;config_name&gt;”)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> renverra vrai ou faux. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afficher uniquement les configurations Spark spécifiques à Spark SQL :: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># En Python </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.sql(“SET -v”).select(“key”, “value”).show(n=5, truncate=False) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keyvaluespark.sql. adaptive.enabledfalsespark.sql.adaptive.nonEmptyPartitionRatioForBroadcastJoin0.2spark.sql.adaptive.shuffle.fetchShuffleBlocksInBatch.enabledtruespark.sql.adaptive.shuffle.localShuffleReader.enabledtruespark.sql.adaptive.shuffle.maxNumPostShufflePartitions&lt;undefined&gt; affichant uniquement les 5 premières lignes </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># En Python </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt;&gt;&gt; spark.conf.get("spark.sql.shuffle.partitions") </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'200' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt;&gt;&gt; spark.conf.set("spark.sql.shuffle.partitions", 5) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&gt;&gt;&gt; spark.conf. get("spark.sql.shuffle.partitions") </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">'5' </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Précédence : </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SparkSession &gt; spark-submit &gt; spark-defaules.conf</font></font></li><li><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voie-4</font></font></strong></li></ol>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Accédez à la configuration actuelle de Spark via l' </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">environnement de l'interface utilisateur Spark.</font></font></strong></p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img decoding="async" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20920%20388&#39;%3E%3C/svg%3E" alt="" class="wp-image-2425" width="920" height="388" title="Nikhil Aggarwal &gt; Réglage des performances Spark &gt; image2022-5-3_18-21-0.png" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-2-spark-UI-1024x435.png"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-2-spark-UI-1024x435.png" alt="" class="wp-image-2425" width="920" height="388" title="Nikhil Aggarwal &gt; Spark Performance Tuning &gt; image2022-5-3_18-21-0.png"/></noscript></figure></div>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Configuration_changes"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modifications de configuration</font></font><span class="ez-toc-section-end"></span></h2>



<h3 class="wp-block-heading"><span class="ez-toc-section" id="Static_vs_Dynamic_allocation"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Allocation statique ou dynamique</font></font><span class="ez-toc-section-end"></span></h3>



<ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le pilote Spark peut demander plus ou moins de ressources de calcul à mesure que la demande de charges de travail importantes fluctue et diminue.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'activation de l'allocation dynamique des ressources permet à Spark d'obtenir une meilleure utilisation des ressources, en libérant les exécuteurs lorsqu'ils ne sont pas utilisés et en en acquérant de nouveaux en cas de besoin.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour activer et configurer l'allocation dynamique, vous pouvez utiliser des paramètres tels que les suivants. Notez que les chiffres ici sont arbitraires&nbsp;; les paramètres appropriés dépendront de la nature de votre charge de travail et doivent être ajustés en conséquence.</font></font></li></ul>



<p><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.enabled vrai </font></font></em><br><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.minExecutors 2 </font></font></em><br><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.schedulerBacklogTimeout 1m </font></font></em><br><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.maxExecutors 20 </font></font></em><br><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.executorIdleTimeout 2min</font></font></em></p>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par défaut, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.enabled</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est défini sur false. Lorsqu'il est activé avec les paramètres affichés ici, le pilote Spark demandera au gestionnaire de cluster de créer au minimum deux exécuteurs pour commencer </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(spark.dynamicAllocation.minExecutors)</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . À mesure que le retard dans la file d'attente des tâches augmente, de nouveaux exécuteurs seront demandés chaque fois que le délai d'expiration du retard ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.schedulerBacklogTimeout</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) est dépassé. Dans ce cas, chaque fois qu'il y a des tâches en attente qui n'ont pas été planifiées depuis plus d'une minute, le pilote demandera qu'un nouvel exécuteur soit lancé pour planifier les tâches en retard, jusqu'à un maximum de 20 ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.maxExecutors</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). En revanche, si un exécuteur termine une tâche et reste inactif pendant 2 minutes ( </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.dynamicAllocation.executorIdleTimeout</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), le pilote Spark y mettra fin.</font></font></p>



<h3 class="wp-block-heading"><span class="ez-toc-section" id="Spark_Executor_memory"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mémoire de l'exécuteur Spark</font></font><span class="ez-toc-section-end"></span></h3>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La quantité de mémoire disponible pour chaque exécuteur est contrôlée par </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.executor.memory</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Celle-ci est divisée en trois sections&nbsp;: </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mémoire d'exécution, mémoire de stockage et mémoire réservée</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La division par défaut est </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de 60&nbsp;% pour la mémoire d'exécution</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de 40&nbsp;% pour le stockage</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , après avoir prévu </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">300&nbsp;Mo de mémoire réservée</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pour se prémunir contre les erreurs de MOO. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mémoire d'exécution est utilisée pour les mélanges, les jointures, les tris et les agrégations Spark. </font></font><br><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.memory.fraction est 0,6 par défaut</font></font></strong></p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img decoding="async" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/spark-3-memory_split-1024x695.png" alt="" class="wp-image-2422 entered lazyloaded" width="555" height="372" title="Nikhil Aggarwal &gt; Réglage des performances Spark &gt; image2022-5-3_18-20-26.png" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-3-memory_split-1024x695.png" data-ll-status="loaded"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-3-memory_split-1024x695.png" alt="" class="wp-image-2422" width="555" height="372" title="Nikhil Aggarwal &gt; Spark Performance Tuning &gt; image2022-5-3_18-20-26.png"/></noscript></figure></div>



<h3 class="wp-block-heading"><span class="ez-toc-section" id="Partition_size"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Taille de la partition</font></font><span class="ez-toc-section-end"></span></h3>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une grande partie de l'efficacité de Spark est due à sa capacité à exécuter plusieurs tâches en parallèle à grande échelle.</font></font></p>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour optimiser l'utilisation des ressources et maximiser le parallélisme, l'idéal est d'avoir au moins </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">autant de partitions qu'il y a de cœurs sur l'exécuteur.</font></font></strong></p>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La taille d'une partition dans Spark est dictée par </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.sql.files.maxPartitionBytes</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La valeur par défaut est 128</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;Mo. Vous pouvez réduire la taille, mais cela peut entraîner ce que l'on appelle le « </font></font><em><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">problème des petits fichiers</font></font></strong></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> » : de nombreux petits fichiers de partition, introduisant une quantité excessive d'E/S disque et une dégradation des performances grâce aux opérations du système de fichiers telles que l'ouverture, la fermeture et le listage. répertoires, ce qui sur un système de fichiers distribué peut être lent.</font></font></p>



<h1 class="wp-block-heading"><span class="ez-toc-section" id="Minimise_Shuffle"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Réduire la lecture aléatoire</font></font><span class="ez-toc-section-end"></span></h1>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spark Shuffle est une opération coûteuse car elle implique les éléments suivants</font></font></p>



<ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E/S disque</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implique la sérialisation et la désérialisation des données</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E/S réseau</font></font></li></ul>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous ne pouvons pas éviter complètement les opérations de lecture aléatoire, mais lorsque cela est possible, essayons de réduire le nombre d'opérations de lecture aléatoire en supprimant toutes les opérations inutilisées.</font></font></p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img decoding="async" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/spark-4-shuffle-1024x519.png" alt="" class="wp-image-2409 entered lazyloaded" width="612" height="308" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-4-shuffle-1024x519.png" data-ll-status="loaded"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-4-shuffle-1024x519.png" alt="" class="wp-image-2409" width="612" height="308"/></noscript></figure></div>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Number_of_shuffle_partitions"></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nombre de partitions aléatoires</font></font><span class="ez-toc-section-end"></span></h2>



<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les partitions aléatoires sont créées pendant l'étape de lecture aléatoire. Par défaut, le nombre de partitions aléatoires est défini sur 200 dans </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">spark.sql.shuffle.partitions</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Vous pouvez ajuster ce nombre en fonction de la taille de l'ensemble de données dont vous disposez, afin de réduire la quantité de petites partitions envoyées sur le réseau aux tâches des exécuteurs.</font></font></p>



<p>Created during operations like groupBy() or join(), also known as wide transformations, shuffle partitions consume both network and disk I/O resources. During these operations, the shuffle will spill results to executors’ local disks at the location specified in <strong>spark.local.directory</strong>. Having performant SSD disks for this operation will boost the performance.</p>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Shuffle_Service_internals"></span>Shuffle Service internals<span class="ez-toc-section-end"></span></h2>



<p>During map and shuffle operations, Spark writes to and reads from the local disk’s shuffle files, so there is heavy I/O activity. This can result in a bottleneck, because the <strong>default configurations are suboptimal for large-scale Spark jobs</strong>. Knowing what configurations to tweak can mitigate this risk during this phase of a Spark job.</p>



<figure class="wp-block-table"><table><tbody><tr><th>Configuration</th><th>Default Value, recommendation and description</th></tr><tr><td><strong>spark.driver.memory</strong></td><td>Default is 1g (1 GB). This is the amount of memory allocated to the Spark driver to receive data from executors. This is often changed during spark-submit with –driver-memory.Only change this if you expect the driver to receive large amounts of data back from operations like collect(), or if you run out of driver memory.</td></tr><tr><td><strong>spark.shuffle.file.buffer</strong></td><td>Default is 32 KB. Recommended is 1 MB. This allows Spark to do more buffering before writing final map results to disk.</td></tr><tr><td><strong>spark.file.transferTo</strong></td><td>Default is true. Setting it to false will force Spark to use the file buffer to transfer files before finally writing to disk; this will decrease the I/O activity.</td></tr><tr><td>spark.shuffle.unsafe.file.output.buffer</td><td>Default is 32 KB. This controls the amount of buffering possible when merging files during shuffle operations. In general, large values (e.g., 1 MB) are more appropriate for larger workloads, whereas the default can work for smaller workloads.</td></tr><tr><td><a href="http://spark.io/">spark.io</a>.compression.lz4.blockSize</td><td>Default is 32 KB. Increase to 512 KB. You can decrease the size of the shuffle file by increasing the compressed size of the block.</td></tr><tr><td>spark.shuffle.service.​index.cache.size</td><td>Default is 100m. Cache entries are limited to the specified memory footprint in byte.</td></tr><tr><td>spark.shuffle.registration.​timeout</td><td>Default is 5000 ms. Increase to 120000 ms.</td></tr><tr><td>spark.shuffle.registration.maxAttempts</td><td>Default is 3. Increase to 5 if needed.</td></tr></tbody></table></figure>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Bucketing"></span>Bucketing<span class="ez-toc-section-end"></span></h2>



<ol><li>Bucketing is another data organisation technique that groups data with the same bucket value.&nbsp;</li><li>Bucketing boosts performance by already sorting and shuffling data before performing sort-merge joins.</li><li>The information about bucketing is stored in the metastore</li><li>vs Partition:<ol><li>Bucketing distributes data across a fixed number of buckets by a hash on the bucket value; whereas, partitioning creates a directory for each partition.&nbsp;</li><li>Bucketing works well when the number of unique values is large; whereas, partitioning should only be used with columns that have a limited number of values.</li><li>Bucketing might be used with or without partitioning.</li></ol></li><li><em><strong>Columns that are commonly used in aggregations and joins as keys are suitable candidates for bucketing.</strong></em> In a general manner, <em>joins</em>, <em>groupBy</em>, <em>distinct</em> transformations are benefited from bucketing.<br>df = df.bucketBy(32, ‘key’).sortBy(‘value’)</li><li>It is important the have the same number of buckets on both sides of the tables in the join.</li></ol>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Optimise_Joins"></span>Optimise Joins<span class="ez-toc-section-end"></span></h2>



<ul><li>Joins are one of the fundamental operation when developing a spark job. So, it is worth knowing about the optimizations before working with joins.</li><li>Spark approaches two types of cluster communication Strategy:<ul><li>node-node communication strategy → Spark shuffles the data across the clusters</li><li>per-node communication strategy → Spark perform broadcast joins</li></ul></li></ul>



<h3 class="wp-block-heading"><span class="ez-toc-section" id="Shuffle_Hash_join"></span>Shuffle Hash join<span class="ez-toc-section-end"></span></h3>



<ul><li>works based on the concept of map reduce</li><li><strong>Map through the data frames and use the values of the join column as output key. Shuffles the data frames based on the output keys and join the data frames in the reduce phase as the rows from the different data frame with the same keys will ended up in the same machine.</strong></li><li>Spark chooses Shuffle Hash join when Sort merge join is turned off or if the key is not suitable</li><li><strong>Creating hash tables are costly</strong> and it can be only done when the average size of a single partition is small enough to build a hash table.</li><li><strong>Note</strong>: Sort merge join is a very good candidate in most of times as it can spill the data to the disk and doesn’t need to hold the data in memory like its counterpart Shuffle Hash join. However, <strong>when the build size is smaller than the stream size Shuffle Hash join will outperform Sort Merge join</strong>.</li><li>To accomplish ideal performance:<ul><li><em>The DataFrame should be distributed evenly on the joining columns.</em></li></ul><ul><li><em>To leverage parallelism the DataFrame should have an adequate number of unique keys.</em></li></ul></li><li><strong>Tips</strong>: During joins if there are rows which are irrelevant to the key, filter the rows before the join. Otherwise, there will be more data shuffle over the network.</li></ul>



<h3 class="wp-block-heading"><span class="ez-toc-section" id="Broadcast_Hash_joins"></span>Broadcast Hash joins<span class="ez-toc-section-end"></span></h3>



<ul><li>Per-node communication strategy.</li><li>Yield the maximum performance in spark.</li><li>it is relevant only for little datasets.</li><li>The smaller table will be broadcasted to all worker nodes. Thus, when working with one large table and another smaller table always makes sure to broadcast the smaller table.</li><li>Recently Spark has increased the maximum size for the broadcast table from 2GB to 8GB. Thus, it is not possible to broadcast tables which are greater than 8GB.</li><li>Spark also internally maintains a threshold of the table size to automatically apply broadcast joins. The threshold can be configured using “<strong>spark.sql.autoBroadcastJoinThreshold</strong>” which is by <strong>default 10MB</strong>.</li><li>We can hint spark to broadcast a table as below:import org.apache.spark.sql.functions.broadcast<br>val dataframe = largedataframe.join(broadcast(smalldataframe), “key”)<ul><li><img decoding="async" width="800" height="331" class="wp-image-2410" style="width: 800px;" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20800%20331&#39;%3E%3C/svg%3E" alt="" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join.png 1400w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join-300x124.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join-1024x424.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join-768x318.png 768w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join.png"><noscript><img decoding="async" width="800" height="331" class="wp-image-2410" style="width: 800px;" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join.png" alt="" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join.png 1400w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join-300x124.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join-1024x424.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-5-broadcast-hash-join-768x318.png 768w" sizes="(max-width: 800px) 100vw, 800px" /></noscript></li></ul></li></ul>



<h3 class="wp-block-heading"><span class="ez-toc-section" id="Shuffle_Sort_merge_join"></span>Shuffle Sort merge join<span class="ez-toc-section-end"></span></h3>



<ul><li><strong>Default join algorithm in spark</strong><ul><li>However, this can be turned down by using the internal parameter ‘<strong>spark.sql.join.preferSortMergeJoin</strong>’ which by <strong>default is true</strong></li></ul></li><li>Composed of 2 steps:<ul><li>The first step is to sort the datasets and,</li></ul><ul><li>Second operation is to merge the sorted data in the partition by iterating over the elements and according to the join key join the rows having the same value.</li></ul></li><li><strong>To accomplish ideal performance in Sort Merge Join:</strong><ul><li><em>Make sure the partitions have been co-located. Otherwise, there will be shuffle operations to co-locate the data as it has a pre-requirement that all rows having the same value for the join key should be stored in the same partition.</em></li></ul><ul><li>The DataFrame should be distributed uniformly on the joining columns.</li></ul><ul><li>To leverage parallelism the DataFrame should have an adequate number of unique keys</li></ul></li></ul>



<h1 class="wp-block-heading"><span class="ez-toc-section" id="Tackle_Skew_Data"></span>Tackle Skew Data<span class="ez-toc-section-end"></span></h1>



<p>When one partition has more data to process as compared to others it result into performance bottleneck due to this uneven distribution of data.</p>



<p>If the data is highly&nbsp;<em>skewed</em>, it might even cause a spill of the data from memory to disk.</p>



<p><strong>Detection</strong>:</p>



<ol><li>To observe the distribution of data among partitions,&nbsp;<em>glom&nbsp;</em>function might be used.</li><li>Additionally, uneven distribution of data might be also detected with the help of task execution time and tasks’ processed data volume information screened in the&nbsp;<em>executor&nbsp;</em>page of Spark UI.</li></ol>



<p><em>partition_number = df.rdd.getNumPartitions()<br>data_distribution = df.rdd.glom().map(len).collect()</em></p>



<p>Spark 3.0 version comes with a nice feature&nbsp;<a href="https://docs.databricks.com/spark/latest/spark-sql/aqe.html">Adaptive Query Execution</a>&nbsp;which automatically balances out the skewness across the partitions</p><div class="google-auto-placed ap_container" style="width: 100%; height: auto; clear: both; text-align: center;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-9040638560872555" data-adsbygoogle-status="done" style="display: block; margin: auto; background-color: transparent; height: 280px;"><div id="aswift_1_host" style="border: none; height: 280px; width: 987px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>



<p>Two separate workarounds come forward to tackle&nbsp;skew&nbsp;in the data distribution among the partitions —&nbsp;salting&nbsp;and&nbsp;repartition.</p>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Salting"></span>Salting<span class="ez-toc-section-end"></span></h2>



<p>It means adding randomization to the data to help it to be distributed more uniformly.</p>



<p>An extra processing cost is paid in return for evenly distributed data across the partitions, and so performance gains.</p>



<p><strong>S<em>alting</em>&nbsp;technique is applied only to the skewed key</strong></p>



<p>random values are added to the key. Then,&nbsp;<em>&lt;key1+random_salting_value&gt;</em>&nbsp;is obtained, and this created new key values are matched with the replicated corresponding key values in the other table if it is a join operation.</p>



<p>For Example: take a look at the following example where the key column is city information in join, and the distribution of the key column is highly skewed in tables. To distribute the data evenly, we append random values from 1 to 5 to the end of key values for the bigger table of join and compose a new column in the smaller table by exploding an array from 1 to 5.</p>



<div class="wp-block-image"><figure class="aligncenter size-full"><img decoding="async" width="940" height="266" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20940%20266&#39;%3E%3C/svg%3E" alt="" class="wp-image-2411" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-6-salting.png 940w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-6-salting-300x85.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-6-salting-768x217.png 768w" data-lazy-sizes="(max-width: 940px) 100vw, 940px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-6-salting.png"><noscript><img decoding="async" width="940" height="266" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-6-salting.png" alt="" class="wp-image-2411" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-6-salting.png 940w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-6-salting-300x85.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-6-salting-768x217.png 768w" sizes="(max-width: 940px) 100vw, 940px" /></noscript></figure></div>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Repartition"></span>Repartition<span class="ez-toc-section-end"></span></h2>



<p><em>Repartition&nbsp;</em>does a full shuffle, creates new partitions, and increases the level of parallelism in the application.&nbsp;</p>



<p>More partitions will help to deal with the data skewness problem with an extra cost that is a shuffling of full data as mentioned above. However adding one shuffle to the query plan might eliminate two other shuffles, and speed up the running</p><div class="google-auto-placed ap_container" style="width: 100%; height: auto; clear: both; text-align: center;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-9040638560872555" data-adsbygoogle-status="done" style="display: block; margin: auto; background-color: transparent; height: 280px;"><div id="aswift_2_host" style="border: none; height: 280px; width: 987px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>



<p>Apart from data skew, I highly recommend taking a look at&nbsp;<a href="https://towardsdatascience.com/should-i-repartition-836f7842298c">this post</a>, which gives examples about the usage of&nbsp;<em>repartition&nbsp;</em>efficiently with use cases and explains the details under the hood.</p>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="AQE_Adaptive_Query_Execution"></span>AQE (Adaptive Query Execution)<span class="ez-toc-section-end"></span></h2>



<p>Adaptive Query Execution is an enhancement enabling Spark 3 to alter physical execution plans at runtime, which allows improvements on the physical implementation based on statistics collected after shuffle exchange operations.</p>



<p>Level of parallelism and join implementation strategy have been shown to be key factors for query performance on large clusters. According to this premise, new optimisation rules have been built on top of the AQE feature:</p>



<ol><li>dynamically coalescing shuffle partitions by eventually merging small adjacent ones.</li><li>dynamically replacing a Sort-Merge join for a Broadcast-Hash join when size conditions are met on any side.</li><li>dynamically optimising skew joins by eventually scheduling multiple reduce tasks to work on a single huge partition.</li></ol>



<p>Set following 3 parameters :&nbsp;</p>



<p>spark.conf.set(“spark.sql.adaptive.enabled”, true)<br>spark.conf.set(“spark.sql.adaptive.skewedJoin.enabled”, true)<br>spark.conf.set(“spark.sql.adaptive.advisoryPartitionSizeInBytes”, “128m”)</p>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Iterative_broadcast_join"></span>Iterative broadcast join<span class="ez-toc-section-end"></span></h2>



<p>Split one of the table into multiple small parts and broadcast it on all executors sequentially to join with skewed table. Combine result at the end.</p>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Skew_hint"></span>Skew hint<span class="ez-toc-section-end"></span></h2>



<p>When you perform a&nbsp;<code>join</code>&nbsp;command with&nbsp;<code>DataFrame</code>&nbsp;or&nbsp;<code>Dataset</code>&nbsp;objects, if you find that the query is stuck on finishing a small number of tasks due to&nbsp;<a href="https://en.wikipedia.org/wiki/Skewness" target="_blank" rel="noreferrer noopener">data skew</a>, you can specify the skew hint with the&nbsp;<code>hint("skew")</code>&nbsp;method:&nbsp;<code>df.hint("skew")</code>. The&nbsp;<a href="https://docs.databricks.com/delta/join-performance/skew-join.html" target="_blank" rel="noreferrer noopener">skew join optimization</a>&nbsp;is performed on the&nbsp;<code>DataFrame</code>&nbsp;for which you specify the&nbsp;<code>skew</code>&nbsp;hint.</p>



<p>In addition to the basic hint, you can specify the&nbsp;<code>hint</code>&nbsp;method with the following combinations of parameters: column name, list of column names, and column name and skew value.</p>



<div class="enlighter-default enlighter-v-standard enlighter-t-enlighter enlighter-l-python enlighter-hover enlighter-linenumbers "><div class="enlighter-toolbar-top enlighter-toolbar"><div class="enlighter-btn enlighter-btn-raw"><div class="enlighter-tooltip"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texte brut</font></font></div></div><div class="enlighter-btn enlighter-btn-copy"><div class="enlighter-tooltip"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copier dans le presse-papier</font></font></div></div><div class="enlighter-btn enlighter-btn-window"><div class="enlighter-tooltip"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ouvrir le code dans une nouvelle fenêtre</font></font></div></div><div class="enlighter-btn enlighter-btn-website"><div class="enlighter-tooltip"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Surligneur de syntaxe EnlighterJS 3</font></font></div></div></div><div class="enlighter-code"><div class="enlighter" style=""><div class=""><div><span class="enlighter-c0">#DataFrame and column name.</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">df.</span><span class="enlighter-m1">hint</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"skew"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"col1"</span><span class="enlighter-g1">)</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0">#DataFrame and multiple columns.</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">df.</span><span class="enlighter-m1">hint</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"skew"</span><span class="enlighter-text">, </span><span class="enlighter-g1">[</span><span class="enlighter-s0">"col1"</span><span class="enlighter-text">,</span><span class="enlighter-s0">"col2"</span><span class="enlighter-g1">])</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text"></span><span class="enlighter-c0">#DataFrame, column name, and skew value.</span><span class="enlighter-text"></span></div></div><div class=""><div><span class="enlighter-text">df.</span><span class="enlighter-m1">hint</span><span class="enlighter-g1">(</span><span class="enlighter-s0">"skew"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"col1"</span><span class="enlighter-text">, </span><span class="enlighter-s0">"value"</span><span class="enlighter-g1">)</span></div></div></div><div class="enlighter-raw"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#DataFrame et nom de la colonne. df.hint("skew", "col1") #DataFrame et plusieurs colonnes. df.hint("skew", ["col1","col2"]) #DataFrame, nom de colonne et valeur d'inclinaison. df.hint("inclinaison", "col1", "valeur")</font></font></div></div><div class="enlighter-toolbar-bottom enlighter-toolbar"></div></div><pre class="EnlighterJSRAW enlighter-origin" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#DataFrame et nom de la colonne.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
df.hint("inclinaison", "col1")</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
#DataFrame et plusieurs colonnes.</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
df.hint("inclinaison", ["col1", "col2"])</font></font><font></font>
<font></font>
#DataFrame, column name, and skew value.<font></font>
df.hint("skew", "col1", "value")</pre>



<h1 class="wp-block-heading"><span class="ez-toc-section" id="Cache_properly"></span>Cache properly<span class="ez-toc-section-end"></span></h1>



<p>To take full advantage of lazy evaluation functionality, it is very wise to&nbsp;<strong>store expensive intermediate results</strong>&nbsp;if several operations use them downstream of the DAG. Indeed, if an action is run, its computation can be based on these intermediate results and thus only replay a sub-part of the DAG before this action.</p>



<p>Let’s take the following DAG as an example:</p>



<figure class="wp-block-image size-large is-resized"><img decoding="async" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20576%20117&#39;%3E%3C/svg%3E" alt="" class="wp-image-2412" width="576" height="117" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1-1024x208.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1-300x61.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1-768x156.png 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1.png 1400w" data-lazy-sizes="(max-width: 576px) 100vw, 576px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1-1024x208.png"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1-1024x208.png" alt="" class="wp-image-2412" width="576" height="117" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1-1024x208.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1-300x61.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1-768x156.png 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-7-DAG-1.png 1400w" sizes="(max-width: 576px) 100vw, 576px" /></noscript></figure>



<p>To obtain the results of the two actions, the treatments are described in the two DAGs below.</p>



<figure class="wp-block-image size-large is-resized"><img decoding="async" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20610%20109&#39;%3E%3C/svg%3E" alt="" class="wp-image-2413" width="610" height="109" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2-1024x183.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2-300x54.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2-768x137.png 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2.png 1400w" data-lazy-sizes="(max-width: 610px) 100vw, 610px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2-1024x183.png"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2-1024x183.png" alt="" class="wp-image-2413" width="610" height="109" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2-1024x183.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2-300x54.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2-768x137.png 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-8-DAG-2.png 1400w" sizes="(max-width: 610px) 100vw, 610px" /></noscript></figure>



<p>In order to speed up the execution, one can decide to cache intermediate results (e.g. the result of a join).</p>



<figure class="wp-block-image size-large is-resized"><img decoding="async" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20619%20136&#39;%3E%3C/svg%3E" alt="" class="wp-image-2415" width="619" height="136" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4-1024x225.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4-300x66.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4-768x168.png 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4.png 1400w" data-lazy-sizes="(max-width: 619px) 100vw, 619px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4-1024x225.png"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4-1024x225.png" alt="" class="wp-image-2415" width="619" height="136" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4-1024x225.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4-300x66.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4-768x168.png 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-10-DAG-4.png 1400w" sizes="(max-width: 619px) 100vw, 619px" /></noscript></figure>



<p>The processing of the second action is now simplified. Note that during the first action the results have not yet been stored in memory.</p>



<figure class="wp-block-image size-large is-resized"><img decoding="async" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20651%20131&#39;%3E%3C/svg%3E" alt="" class="wp-image-2414" width="651" height="131" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3-1024x206.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3-300x60.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3-768x155.png 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3.png 1400w" data-lazy-sizes="(max-width: 651px) 100vw, 651px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3-1024x206.png"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3-1024x206.png" alt="" class="wp-image-2414" width="651" height="131" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3-1024x206.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3-300x60.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3-768x155.png 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-9-DAG-3.png 1400w" sizes="(max-width: 651px) 100vw, 651px" /></noscript></figure>



<p>If this caching can speed up execution of a job, we pay a&nbsp;<strong>cost when these results are written to memory and/or disk</strong>. It should be tested at different locations in the processing pipeline whether the total time saving outweighs the cost. This is especially relevant when there are several paths on the DAG.</p>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img decoding="async" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20741%20286&#39;%3E%3C/svg%3E" alt="" class="wp-image-2416" width="741" height="286" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching-1024x396.jpeg 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching-300x116.jpeg 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching-768x297.jpeg 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching.jpeg 1254w" data-lazy-sizes="(max-width: 741px) 100vw, 741px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching-1024x396.jpeg"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching-1024x396.jpeg" alt="" class="wp-image-2416" width="741" height="286" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching-1024x396.jpeg 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching-300x116.jpeg 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching-768x297.jpeg 768w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-11-Caching.jpeg 1254w" sizes="(max-width: 741px) 100vw, 741px" /></noscript></figure></div>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Caching"></span>Caching<span class="ez-toc-section-end"></span></h2>



<p>cache() will store as many of the partitions read in memory across Spark executors as memory allows.</p>



<p>While a DataFrame may be fractionally cached, partitions cannot be fractionally cached (e.g., if you have 8 partitions but only 4.5 partitions can fit in memory, only 4 will be cached). However, if not all your partitions are cached, when you want to access the data again, the partitions that are not cached will have to be recomputed, slowing down your Spark job.</p>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Persistence"></span>Persistence<span class="ez-toc-section-end"></span></h2>



<p>Persist(StorageLevel.LEVEL) is nuanced, providing control over how your data is cached via StorageLevel</p>



<figure class="wp-block-table"><table><tbody><tr><th>StorageLevel</th><th>Description</th></tr><tr><td>MEMORY_ONLY</td><td>Data is stored directly as objects and stored only in memory.</td></tr><tr><td>MEMORY_ONLY_SER</td><td>Data is serialized as compact byte array representation and stored only in memory. To use it, it has to be deserialized at a cost.</td></tr><tr><td>MEMORY_AND_DISK</td><td>Data is stored directly as objects in memory, but if there’s insufficient memory the rest is serialized and stored on disk.</td></tr><tr><td>DISK_ONLY</td><td>Data is serialized and stored on disk.</td></tr><tr><td>OFF_HEAP</td><td>Data is stored off-heap. Off-heap memory is used in Spark for storage and query execution; see “Configuring Spark executors’ memory and the shuffle service”.</td></tr><tr><td>MEMORY_AND_DISK_SER</td><td>Like MEMORY_AND_DISK, but data is serialized when stored in memory. (Data is always serialized when stored on disk.)</td></tr></tbody></table></figure>



<h1 class="wp-block-heading"><span class="ez-toc-section" id="Best_Practices"></span>Best Practices<span class="ez-toc-section-end"></span></h1>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Use_DataframeDataset_over_RDD"></span>Use Dataframe/Dataset over RDD<span class="ez-toc-section-end"></span></h2>



<ul><li>Using <strong>RDD</strong> directly leads to performance issues as Spark doesn’t know how to apply the optimization techniques and RDD serialize and de-serialize the data when it distributes across a cluster (repartition &amp; shuffling).<ul><li>Serialization and de-serialization are very expensive operations for Spark applications or any distributed systems, most of our time is spent only on serialization of data rather than executing the operations hence try to avoid using RDD.</li></ul></li></ul>



<ul><li>The <strong>DataFrame</strong> API does two things that help to do this (through the Tungsten project).<ul><li>First, using off-heap storage for data in binary format.</li><li>Second, generating encoder code on the fly to work with this binary format for your specific objects.</li><li>Since Spark/PySpark DataFrame internally stores data in binary there is no need of Serialization and deserialization data when it distributes across a cluster hence you would see a performance improvement.</li></ul></li></ul>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Use_coalesce_over_repartition"></span>Use coalesce() over repartition()<span class="ez-toc-section-end"></span></h2>



<ul><li>coalesce() is an optimised and improved version of repartition()</li><li>coalesce() → decreases/increases the number of partitions while <strong>avoiding a&nbsp;</strong><strong><em>shuffle</em></strong>&nbsp;in the network. As it does not redistribute the complete data, so this does not solve imbalance problem in distribution of data.</li><li>repartition() → <strong>creates new partitions by full shuffling of data(</strong>costly). As data got evenly distributed, so it increases degree of parallelism.</li></ul>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="use_mapPartitions_over_map"></span>use mapPartitions() over map()<span class="ez-toc-section-end"></span></h2>



<ul><li>Both are RDD based operations</li><li>Spark&nbsp;<code>mapPartitions()</code>&nbsp;provides a facility to do heavy initializations (for example Database connection) once for each partition instead of doing it on every DataFrame row. This helps the performance of the Spark jobs when you dealing with heavy-weighted initialization on larger datasets.</li><li>Whereas in the map() it does the same on one row each time.</li><li><strong>Note</strong>: One key point to remember is these both transformations returns the Dataset[U] but not the DataFrame (In Spark 2.0, &nbsp;DataFrame = Dataset[Row])</li></ul>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Avoid_UDFs"></span>Avoid UDFs<span class="ez-toc-section-end"></span></h2>



<ul><li>Try to&nbsp;<a href="https://sparkbyexamples.com/spark/spark-sql-udf/">avoid Spark/PySpark UDF’s</a>&nbsp;at any cost and use when existing Spark built-in functions are not available for use.</li><li>User-defined functions de-serialize each row to object, apply the lambda function and re-serialize it resulting in slower execution and more garbage collection time.</li><li>UDF’s are a black box to Spark hence it can’t apply optimisation and you will lose all the optimisation Spark does on Dataframe/Dataset.</li></ul>



<div class="wp-block-image"><figure class="aligncenter size-large is-resized"><img decoding="async" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20754%20317&#39;%3E%3C/svg%3E" alt="" class="wp-image-2417" width="754" height="317" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-12-udfs-1024x433.jpeg"><noscript><img decoding="async" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-12-udfs-1024x433.jpeg" alt="" class="wp-image-2417" width="754" height="317"/></noscript></figure></div>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Disable_unnecessary_DEBUG_and_INFO_logging"></span>Disable unnecessary DEBUG and INFO logging<span class="ez-toc-section-end"></span></h2>



<ul><li>This is one of the simple ways to improve the performance of Spark Jobs and can be easily avoided by following good coding principles.</li><li>During the development phase of Spark/PySpark application, we usually write debug/info messages to console using&nbsp;<code>println()</code>&nbsp;and logging to a file using some logging framework (log4j);</li><li>These both methods results I/O operations hence cause performance issues when you run Spark jobs with greater workloads. Before promoting your jobs to production make sure you review your code and take care of the following.</li></ul>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Checkpointing"></span>Checkpointing<span class="ez-toc-section-end"></span></h2>



<ul><li><a href="https://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.checkpoint"><em>Checkpoint</em>&nbsp;</a>truncates the execution plan and saves the checkpointed data frame to a temporary location on the disk and reload it back in – it comes up as a performance-boosting factor</li></ul>



<ul><li>The point is that each time you apply a transformation or perform a query on a data frame, the query plan grows. Spark keeps all history of transformations applied on a data frame that can be seen when run&nbsp;<em>explain</em>&nbsp;command on the data frame. When the query plan starts to be huge, the performance decreases dramatically, generating bottlenecks.<ul><li>In this manner,&nbsp;<em>checkpoint&nbsp;</em>helps to refresh the query plan and to materialize the data. It is ideal for scenarios including iterative algorithms and branching out a new data frame to perform different kinds of analytics. More tangibly, after&nbsp;<em>checkpointing&nbsp;</em>the data frame, you don’t need to recalculate all of the previous transformations applied on the data frame, it is stored on disk forever.</li></ul></li><li>Note that, Spark won’t clean up the checkpointed data even after the&nbsp;<em>sparkContext&nbsp;</em>is destroyed and the clean-ups need to be managed by the application.</li><li>It is also a good property of&nbsp;<em>checkpointing&nbsp;</em>to debug the data pipeline by checking the status of data frames.</li><li>Caching is also an alternative for a similar purpose in order to increase performance. It obviously requires much more memory compared to&nbsp;<em>checkpointing</em>. There is a good comparison between&nbsp;<em>caching</em>&nbsp;and&nbsp;<em>checkpointing</em>, and when to prefer one of them to the other. You can take a look at&nbsp;<a href="https://medium.com/@adrianchang/apache-spark-checkpointing-ebd2ec065371">here</a>.</li></ul>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="Use_proper_file_formats"></span>Use proper file formats<span class="ez-toc-section-end"></span></h2>



<ul><li><a href="https://parquet.apache.org/">Apache Parquet</a>&nbsp;is a columnar storage format designed to select only queried columns and skip over the rest. It gives the fastest read performance with Spark.</li><li><em>Parquet&nbsp;</em>arranges data in columns, putting related values close to each other to optimize query performance, minimize I/O, and facilitate compression.</li><li>Furthermore, it implements&nbsp;<a href="https://umbertogriffo.gitbook.io/apache-spark-best-practices-and-tuning/storage/use-the-best-data-format">column pruning and predicate pushdown</a>&nbsp;(filters based on stats) which is simply a process of only selecting the required data for processing when querying a huge table. It prevents loading unnecessary parts of the data in-memory and reduces network usage.<ul><li><img decoding="async" width="800" height="492" class="wp-image-2418" style="width: 800px;" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%20800%20492&#39;%3E%3C/svg%3E" alt="" data-lazy-srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat.png 1180w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat-300x184.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat-1024x629.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat-768x472.png 768w" data-lazy-sizes="(max-width: 800px) 100vw, 800px" data-lazy-src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat.png"><noscript><img decoding="async" width="800" height="492" class="wp-image-2418" style="width: 800px;" src="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat.png" alt="" srcset="https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat.png 1180w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat-300x184.png 300w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat-1024x629.png 1024w, https://dataforgeeks.com/wp-content/uploads/2022/05/spark-13-fileformat-768x472.png 768w" sizes="(max-width: 800px) 100vw, 800px" /></noscript></li></ul></li></ul>



<h2 class="wp-block-heading"><span class="ez-toc-section" id="use_toPandas_with_pyArrow"></span>use toPandas() with pyArrow<span class="ez-toc-section-end"></span></h2>



<ul><li><a href="https://arrow.apache.org/">Apache Arrow</a>&nbsp;is a cross-language development platform for in-memory data. It specifies a standardized language-independent columnar memory format for flat and hierarchical data. More clearly,&nbsp;Apache Arrow&nbsp;is a bridge between cross-language platforms that facilities reading a Spark data frame and then writing data frame into Apache Cassandra without suffering enormous inefficient serialization and deserialization performance.</li><li>Apache&nbsp;PyArrow&nbsp;is the Python implementation of Arrow. It provides a Python API that brings together the functionalities of Arrow with Python environment including leading libraries like&nbsp;pandas&nbsp;and&nbsp;numpy</li><li>In Spark, data is processed very fast as long as it is in JVM. However, for some reasons like rich and talented data processing libraries in Python, the data might be moved between Python environment and JVM by Pyspark developers. In this sense, utilizing&nbsp;PyArrow&nbsp;while moving from pandas data frame to Spark data frame or vice-versa results in a huge performance improvement.</li></ul>



<h1 class="wp-block-heading"><span class="ez-toc-section" id="Takeaways"></span>Takeaways<span class="ez-toc-section-end"></span></h1>



<ol><li>Don’t use&nbsp;<em>count()</em>&nbsp;when you don’t need to return the exact number of rows. To check if data frame is empty,&nbsp;<em>len(df.head(1))&gt;0&nbsp;</em>will be more accurate considering the performance issues.</li><li>Do not use&nbsp;<em>show()</em>&nbsp;in your production code.</li><li>It is a good practice to use&nbsp;<em>df.explain()&nbsp;</em>to get insight into the internal representation of a data frame in Spark(the final version of the physical plan).</li><li>Always try to minimize the data size by filtering irrelevant data(rows/columns) before joinings.</li><li>Monitor Spark applications online/offline. It might give you&nbsp;<a href="https://developer.hpe.com/blog/Ql2DXNL4rmhWB8AEDMQz/tips-and-best-practices-to-take-advantage-of-spark-2x">any clues</a>&nbsp;about unbalanced data partitions, where the jobs are stuck, and query plans. An alternative to Spark UI might be&nbsp;<a href="https://medium.com/knoldus/ganglia-cluster-monitoring-monitoring-spark-cluster-77786b8bd38d">Ganglia</a>.</li><li>Basically, avoid using loops.</li><li>Focus on built-in functions rather than custom solutions.</li><li>Ensure that key columns in&nbsp;<em>join&nbsp;</em>operation do not include null values.</li><li><a href="https://medium.com/softwaresanders/improving-your-apache-spark-application-performance-ec5d64bc3c75">Put the bigger dataset on the left in joins</a>.</li><li>Keep in mind that Spark runs with&nbsp;<em>Lazy Evaluation</em>&nbsp;logic. So, nothing is triggered until an action is called. That might result in&nbsp;<a href="https://medium.com/enigma-engineering/things-i-wish-id-known-about-spark-when-i-started-one-year-later-edition-d767430181ed">meaningless error</a>&nbsp;codes.</li><li>Unpersist the data in the cache, if you don’t need it for the rest of the code.</li><li>Close/stop your Spark session when you are done with your application.</li><li>In&nbsp;<a href="https://medium.com/@ch.nabarun/whats-new-in-spark-3-8250a65b3144">Spark 3.0</a>, significant improvements are achieved to tackle performance issues by&nbsp;<a href="https://databricks.com/blog/2020/05/29/adaptive-query-execution-speeding-up-spark-sql-at-runtime.html"><em>Adaptive Query Execution</em></a>, take upgrading the version into consideration.</li><li>Prefer data frames to RDDs for data manipulations.</li><li>In general, tasks larger than about&nbsp;<strong>20 KiB</strong>&nbsp;are probably worth optimizing.</li><li>In general, it is recommended&nbsp;<strong>2–3 tasks per CPU core</strong>&nbsp;in your cluster.</li><li>It is always good to have a block within&nbsp;<strong>128MB</strong>&nbsp;per partition to achieve parallelism.</li><li><em>Csv&nbsp;</em>and&nbsp;<em>Json&nbsp;</em>data file formats give high write performance but are slower for reading, on the other hand,&nbsp;<em>Parquet&nbsp;</em>file format is very fast and gives the best performance in reading and slower than the other mentioned file formats concerning writing operation.</li><li>The physical plan is read from the bottom up, whereas the DAG is read from the top down.</li><li>The&nbsp;<em>Exchange&nbsp;</em>means a shuffle occurred between stages, and it is basically a performance degradation.</li><li>An excessive number of stages might be a sign of a performance problem.</li><li><a href="https://spark.apache.org/docs/latest/tuning.html#garbage-collection-tuning">Garbage collection(GC)</a>&nbsp;is another key factor that might cause performance issues. Check it out from the&nbsp;<em>Executors</em>&nbsp;tab of Spark UI. You may typically use Java GC options in any GC-related case.</li><li>Serialization also plays an important role in the performance of any distributed application. Formats that are slow to serialize objects into, or consume a large number of bytes, will greatly slow down the computation. For Scala/Java-based Spark applications,&nbsp;<a href="https://spark.apache.org/docs/latest/tuning.html#data-serialization">Kryo serialization</a>&nbsp;is highly recommended. In Pyspark,&nbsp;<a href="https://spark.apache.org/docs/latest/api/python/_modules/pyspark/serializers.html">Marshal and Pickle&nbsp;</a>serializers are supported,&nbsp;<em>MarshalSerializer&nbsp;</em>is faster than&nbsp;<em>PickleSerializer&nbsp;</em>but supports fewer data types.</li><li>Note that you might experience a performance loss if you prefer to use Spark in the&nbsp;<em>docker&nbsp;</em>environment.</li></ol>



<h1 class="wp-block-heading"><span class="ez-toc-section" id="References"></span>References<span class="ez-toc-section-end"></span></h1>



<ol><li>https://www.oreilly.com/library/view/learning-spark-2nd/9781492050032/</li><li><a href="https://sparkbyexamples.com/spark/spark-performance-tuning/">https://sparkbyexamples.com/spark/spark-performance-tuning/</a></li><li><a href="http://analyticsvidhya.com/blog/2021/08/best-practices-and-performance-tuning-activities-for-pyspark/">analyticsvidhya.com/blog/2021/08/best-practices-and-performance-tuning-activities-for-pyspark/</a></li><li><a href="https://towardsdatascience.com/apache-spark-performance-boosting-e072a3ec1179">https://towardsdatascience.com/apache-spark-performance-boosting-e072a3ec1179</a></li><li><a href="https://medium.com/datakaresolutions/optimize-spark-sql-joins-c81b4e3ed7da">https://medium.com/datakaresolutions/optimize-spark-sql-joins-c81b4e3ed7da</a></li><li><a href="https://towardsdatascience.com/6-recommendations-for-optimizing-a-spark-job-5899ec269b4b">https://towardsdatascience.com/6-recommendations-for-optimizing-a-spark-job-5899ec269b4b</a></li><li><a href="https://databricks.com/fr/session/optimizing-apache-spark-sql-joins">https://databricks.com/fr/session/optimizing-apache-spark-sql-joins</a></li><li><a href="https://medium.com/swlh/spark-sql-adaptive-query-execution-3adc68973c91">https://medium.com/swlh/spark-sql-adaptive-query-execution-3adc68973c91</a></li><li><a href="https://medium.com/nerd-for-tech/5-most-common-spark-performance-problems-9924b863421f">https://medium.com/nerd-for-tech/5-most-common-spark-performance-problems-9924b863421f</a></li><li><a href="https://medium.com/curious-data-catalog/sparks-skew-problem-does-it-impact-performance-257cdef53680">https://medium.com/curious-data-catalog/sparks-skew-problem-does-it-impact-performance-257cdef53680</a></li><li><a href="https://medium.com/curious-data-catalog/sparks-salting-a-step-towards-mitigating-skew-problem-5b2e66791620">https://medium.com/curious-data-catalog/sparks-salting-a-step-towards-mitigating-skew-problem-5b2e66791620</a></li><li><a href="https://medium.com/curious-data-catalog/spill-often-ignored-sparks-performance-problem-9b4c1ea962f">https://medium.com/curious-data-catalog/spill-often-ignored-sparks-performance-problem-9b4c1ea962f</a></li><li><a href="https://medium.com/curious-data-catalog/shuffle-why-am-i-getting-oom-errors-de4c723d2325">https://medium.com/curious-data-catalog/shuffle-why-am-i-getting-oom-errors-de4c723d2325</a></li><li><a href="https://medium.com/curious-data-catalog/bucketing-are-you-leveraging-it-in-a-right-way-70dc1659bd19">https://medium.com/curious-data-catalog/bucketing-are-you-leveraging-it-in-a-right-way-70dc1659bd19</a></li><li>https://luminousmen.com/post/spark-tips-partition-tuning</li><li>https://www.xenonstack.com/blog/apache-spark-optimisation</li></ol>
<div class="post-views content-post post-2305 entry-meta">
				<span class="post-views-icon dashicons dashicons-chart-bar"></span> <span class="post-views-label">Views:</span> <span class="post-views-count">14,254</span>
			</div>		</div>

				<footer class="entry-meta" aria-label="Méta d&#39;entrée">
			<span class="cat-links"><span class="screen-reader-text">Categories </span><a href="https://dataforgeeks.com/category/general/" rel="category tag">General</a></span> <span class="tags-links"><span class="screen-reader-text">Tags </span><a href="https://dataforgeeks.com/tag/apache-spark/" rel="tag">apache spark</a>, <a href="https://dataforgeeks.com/tag/big-data/" rel="tag">big data</a>, <a href="https://dataforgeeks.com/tag/bigdata/" rel="tag">bigdata</a>, <a href="https://dataforgeeks.com/tag/optimisation/" rel="tag">optimisation</a>, <a href="https://dataforgeeks.com/tag/partition/" rel="tag">partition</a>, <a href="https://dataforgeeks.com/tag/spark/" rel="tag">spark</a>, <a href="https://dataforgeeks.com/tag/tuning/" rel="tag">tuning</a></span> 		<nav id="nav-below" class="post-navigation" aria-label="Des postes">
			<div class="nav-previous"><span class="prev"><a href="https://dataforgeeks.com/data-serialisation-avro-vs-protocol-buffers/2015/" rel="prev">Data Serialisation – Avro vs Protocol Buffers</a></span></div><div class="nav-next"><span class="next"><a href="https://dataforgeeks.com/snowflake-performance-tuning-and-best-practices/2338/" rel="next">Snowflake – Performance Tuning and Best Practices</a></span></div>		</nav>
				</footer>
			</div>
</article>

			<div class="comments-area">
				<div id="comments">

	<h3 class="comments-title">1 thought on “Apache Spark – Performance Tuning and Best Practices”</h3>
		<ol class="comment-list">
			
		<li id="comment-204" class="comment even thread-even depth-1">
			<article class="comment-body" id="div-comment-204" itemtype="https://schema.org/Comment" itemscope="">
				<footer class="comment-meta" aria-label="Méta du commentaire">
					<img alt="" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%2050%2050&#39;%3E%3C/svg%3E" data-lazy-srcset="https://secure.gravatar.com/avatar/3a717b29ac5587b0579ac7e7226c4300?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" decoding="async" data-lazy-src="https://secure.gravatar.com/avatar/3a717b29ac5587b0579ac7e7226c4300?s=50&amp;d=mm&amp;r=g"><noscript><img alt='' src='https://secure.gravatar.com/avatar/3a717b29ac5587b0579ac7e7226c4300?s=50&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/3a717b29ac5587b0579ac7e7226c4300?s=100&#038;d=mm&#038;r=g 2x' class='avatar avatar-50 photo' height='50' width='50' decoding='async'/></noscript>					<div class="comment-author-info">
						<div class="comment-author vcard" itemprop="author" itemtype="https://schema.org/Person" itemscope="">
							<cite itemprop="name" class="fn"><a href="https://servreality.com/technologies/scala-development/" class="url" rel="ugc external nofollow">scala development</a></cite>						</div>

													<div class="entry-meta comment-metadata">
								<a href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#comment-204">									<time datetime="2023-05-09T20:53:16+00:00" itemprop="datePublished">
										May 9, 2023 at 8:53 pm									</time>
								</a>							</div>
												</div>

									</footer>

				<div class="comment-content" itemprop="text">
					<p>Excellent post however , I was wondering if you could write<br>
a litte more on this topic? I’d be very thankful if you could elaborate a little bit more.<br>
Cheers!</p>
<span class="reply"><a rel="nofollow" class="comment-reply-link" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#comment-204" data-commentid="204" data-postid="2305" data-belowelement="div-comment-204" data-respondelement="respond" data-replyto="Reply to scala development" aria-label="Répondre au développement scala">Reply</a></span>				</div>
			</article>
			</li><div class="google-auto-placed" style="width: 100%; height: auto; clear: none; text-align: center;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-9040638560872555" data-adsbygoogle-status="done" style="display: block; margin: 10px auto; background-color: transparent; height: 280px;"><div id="aswift_3_host" style="border: none; height: 280px; width: 987px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div><!-- #comment-## -->
		</ol><!-- .comment-list -->

			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://dataforgeeks.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate="" data-np-autofill-form-type="identity" data-np-checked="1" data-np-watching="1"> <!-- OneAll.com / Social Login for WordPress / v5.7 -->
<div class="oneall_social_login">
 <div class="oneall_social_login_label" style="margin-bottom: 3px;"><label>Connect with:</label></div>
 <div class="oneall_social_login_providers" id="oneall_social_login_providers_4606328" data-processed="true" style="min-height: 61px;"><iframe id="oa_social_login_frame_26041" frameborder="0" scrolling="no" allowtransparency="true" data-processed="true" title="Connectez-vous avec les réseaux sociaux" name="OneAll Social Login" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/saved_resource.html" style="border: 0px none; width: 987px; height: 61px; background-color: transparent;"></iframe></div>
 <script data-cfasync="false" type="text/javascript">
  var _oneall = _oneall || [];
  _oneall.push(['social_login', 'set_providers', ['facebook','google','linkedin','twitter','windowslive']]);
  _oneall.push(['social_login', 'set_callback_uri', (window.location.href + ((window.location.href.split('?')[1] ? '&amp;': '?') + "oa_social_login_source=comments"))]);
  _oneall.push(['social_login', 'set_custom_css_uri', 'https://secure.oneallcdn.com/css/api/socialize/themes/wordpress/default.css']);
  _oneall.push(['social_login', 'do_render_ui', 'oneall_social_login_providers_4606328']);
 </script>
</div><p class="comment-form-comment"><label for="comment" class="screen-reader-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commentaire</font></font></label><textarea id="comment" name="comment" cols="45" rows="8" required="" data-np-intersection-state="visible"></textarea></p><label for="author" class="screen-reader-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nom</font></font></label><input placeholder="Nom *" id="author" name="author" type="text" value="" size="30" required="" data-np-autofill-field-type="lastName">
<label for="email" class="screen-reader-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E-mail</font></font></label><input placeholder="E-mail *" id="email" name="email" type="email" value="" size="30" required="" data-np-autofill-field-type="email">
<label for="url" class="screen-reader-text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Site web</font></font></label><input placeholder="Site web" id="url" name="url" type="url" value="" size="30" data-np-intersection-state="visible">
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enregistrez mon nom, mon adresse e-mail et mon site Web dans ce navigateur pour la prochaine fois que je commenterai.</font></font></label></p>
<p class="form-submit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><input name="submit" type="submit" id="submit" class="submit" value="Poster un commentaire"></font></font> <input type="hidden" name="comment_post_ID" value="2305" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->
			</div>

					</main>
	</div>

	<div class="widget-area sidebar is-right-sidebar grid-25 tablet-grid-25 grid-parent" id="right-sidebar">
	<div class="inside-right-sidebar">
		<aside id="oa-social-login-2" class="widget inner-padding widget_oa-social-login"><h2 class="widget-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se connecter avec:</font></font></h2> <!-- OneAll.com / Social Login for WordPress / v5.7 -->
<div class="oneall_social_login">
 <div class="oneall_social_login_providers" id="oneall_social_login_providers_4622719" data-processed="true" style="min-height: 64px;"><iframe id="oa_social_login_frame_108215" frameborder="0" scrolling="no" allowtransparency="true" data-processed="true" title="Connectez-vous avec les réseaux sociaux" name="OneAll Social Login" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/saved_resource(1).html" style="border: 0px none; width: 280px; height: 64px; background-color: transparent;"></iframe></div>
 <script data-cfasync="false" type="text/javascript">
  var _oneall = _oneall || [];
  _oneall.push(['social_login', 'set_providers', ['facebook','google','linkedin','twitter','windowslive']]);
  _oneall.push(['social_login', 'set_callback_uri', (window.location.href + ((window.location.href.split('?')[1] ? '&amp;': '?') + "oa_social_login_source=widget"))]);
  _oneall.push(['social_login', 'set_custom_css_uri', 'https://secure.oneallcdn.com/css/api/socialize/themes/wordpress/modern.css']);
  _oneall.push(['social_login', 'do_render_ui', 'oneall_social_login_providers_4622719']);
 </script>
</div></aside><aside id="categories-2" class="widget inner-padding widget_categories"><h2 class="widget-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catégories</font></font></h2>
			<ul>
					<li class="cat-item cat-item-28"><a href="https://dataforgeeks.com/category/big-data/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mégadonnées</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (9)
</font></font><ul class="children">
	<li class="cat-item cat-item-35"><a href="https://dataforgeeks.com/category/big-data/hdfs/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HDFS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1)
</font></font></li>
	<li class="cat-item cat-item-29"><a href="https://dataforgeeks.com/category/big-data/impala/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Impala</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (5)
</font></font></li>
	<li class="cat-item cat-item-14"><a href="https://dataforgeeks.com/category/big-data/sqoop/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Squoop</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (3)
</font></font></li>
</ul>
</li>
	<li class="cat-item cat-item-1"><a href="https://dataforgeeks.com/category/general/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Général</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (10)
</font></font></li>
	<li class="cat-item cat-item-7"><a href="https://dataforgeeks.com/category/redshift/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redshift</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (1)
</font></font></li>
	<li class="cat-item cat-item-3"><a href="https://dataforgeeks.com/category/sql/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SQL</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (15)
</font></font></li>
			</ul>

			</aside><aside id="wpforms-widget-2" class="widget inner-padding wpforms-widget"><div class="wpforms-container wpforms-container-full" id="wpforms-2005"><form id="wpforms-form-2005" class="wpforms-validate wpforms-form" data-formid="2005" method="post" enctype="multipart/form-data" action="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/" data-token="a03e54dc7ef8db648f27af11d5201653" novalidate="novalidate" data-np-autofill-form-type="subscribe" data-np-checked="1" data-np-watching="1"><noscript class="wpforms-error-noscript">Please enable JavaScript in your browser to complete this form.</noscript><div class="wpforms-field-container"><div id="wpforms-2005-field_1-container" class="wpforms-field wpforms-field-email" data-field-id="1"><label class="wpforms-field-label" for="wpforms-2005-field_1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E-mail </font></font><span class="wpforms-required-label"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*</font></font></span></label><input type="email" id="wpforms-2005-field_1" class="wpforms-field-large wpforms-field-required" name="wpforms[fields][1]" spellcheck="false" required="" data-np-autofill-field-type="email"></div></div><!-- .wpforms-field-container --><div class="wpforms-field wpforms-field-hp"><label for="wpforms-2005-field-hp" class="wpforms-field-label">Message</label><input type="text" name="wpforms[hp]" id="wpforms-2005-field-hp" class="wpforms-field-medium"></div><div class="wpforms-submit-container"><input type="hidden" name="wpforms[id]" value="2005"><input type="hidden" name="wpforms[author]" value="1"><input type="hidden" name="wpforms[post_id]" value="2305"><button type="submit" name="wpforms[submit]" id="wpforms-submit-2005" class="wpforms-submit" data-alt-text="Sending..." data-submit-text="Subscribe" aria-live="assertive" value="wpforms-submit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S'abonner</font></font></button></div></form></div>  <!-- .wpforms-container --></aside><aside id="rss-2" class="widget inner-padding widget_rss"><h2 class="widget-title"><a class="rsswidget rss-widget-feed" href="http://feeds.feedburner.com/Dataforgeeks"><img class="rss-widget-icon entered exited" style="border:0" width="14" height="14" alt="RSS" data-lazy-src="https://dataforgeeks.com/wp-includes/images/rss.png" src="data:image/svg+xml,%3Csvg%20xmlns=&#39;http://www.w3.org/2000/svg&#39;%20viewBox=&#39;0%200%2014%2014&#39;%3E%3C/svg%3E"><noscript><img class="rss-widget-icon" style="border:0" width="14" height="14" src="https://dataforgeeks.com/wp-includes/images/rss.png" alt="RSS" /></noscript></a> <a class="rsswidget rss-widget-title" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flux inconnu</font></font></a></h2></aside><aside id="archives-2" class="widget inner-padding widget_archive"><h2 class="widget-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les archives</font></font></h2>
			<ul>
					<li><a href="https://dataforgeeks.com/date/2022/05/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mai 2022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(2)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2022/03/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mars 2022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2022/02/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">février 2022</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2020/05/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mai 2020</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2019/11/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">novembre 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2019/07/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juillet 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2019/05/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mai 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2019/03/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mars 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2018/12/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">décembre 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(2)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2018/08/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">août 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(2)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2018/07/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juillet 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(2)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2018/06/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juin 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2018/05/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mai 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(2)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2018/04/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avril 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(1)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2018/03/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mars 2018</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(2)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2016/07/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juillet 2016</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(4)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2016/06/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juin 2016</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(3)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2015/06/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juin 2015</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(2)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2011/10/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">octobre 2011</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(3)</font></font></li>
	<li><a href="https://dataforgeeks.com/date/2009/11/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">novembre 2009</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &nbsp;(2)</font></font></li>
			</ul>

			</aside><aside id="block-4" class="widget inner-padding widget_block"><script async="" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/f(3).txt" crossorigin="anonymous" data-checked-head="true"></script></aside>	</div>
</div>

	</div><div class="google-auto-placed" style="width: 100%; height: auto; clear: none; text-align: center;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-9040638560872555" data-adsbygoogle-status="done" style="display: block; margin: 10px auto; background-color: transparent; height: 280px;"><div id="aswift_5_host" style="border: none; height: 280px; width: 1200px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div>
</div>


<div class="google-auto-placed" style="width: 100%; height: auto; clear: none; text-align: center;"><ins data-ad-format="auto" class="adsbygoogle adsbygoogle-noablate" data-ad-client="ca-pub-9040638560872555" data-adsbygoogle-status="done" style="display: block; margin: 10px auto; background-color: transparent; height: 280px;"><div id="aswift_4_host" style="border: none; height: 280px; width: 1200px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"></div></ins></div><div class="site-footer">
			<footer class="site-info" aria-label="Site" itemtype="https://schema.org/WPFooter" itemscope="">
			<div class="inside-site-info grid-container grid-parent">
								<div class="copyright-bar"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
					© 2022 DataForGeeks				</font></font></div>
			</div>
		</footer>
		</div>

<a title="Revenir en haut" aria-label="Revenir en haut" rel="nofollow" href="https://dataforgeeks.com/apache-spark-performance-tuning-and-best-practices/2305/#" class="generate-back-to-top generate-back-to-top__show" data-scroll-speed="400" data-start-scroll="300">
					
				</a>

<!--[if lte IE 11]>
<script src="https://dataforgeeks.com/wp-content/themes/generatepress/assets/js/classList.min.js?ver=3.4.0" id="generate-classlist-js"></script>
<![endif]-->
<script id="generate-menu-js-extra">
var generatepressMenu = {"toggleOpenedSubMenus":"1","openSubMenuLabel":"Open Sub-Menu","closeSubMenuLabel":"Close Sub-Menu"};
</script>

<script id="generate-back-to-top-js-extra">
var generatepressBackToTop = {"smooth":"1"};
</script>










<script>window.lazyLoadOptions=[{elements_selector:"img[data-lazy-src],.rocket-lazyload,iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}},{elements_selector:".rocket-lazyload",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,}];window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(var i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script data-no-minify="1" async="" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/lazyload.min.js"></script>
<script src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/50ccac416398425f04b7054ba018fb67.js" data-minify="1" defer=""></script>


<nordpass-passkeys><template shadowrootmode="closed" shadowrootdelegatesfocus><script type="text/javascript" src="chrome-extension://eiaeiblijfjekdanodkjadfinkhbfgcd/jsAndWasm/passkeys.js"></script></template></nordpass-passkeys><ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done" style="display: none !important;" data-ad-status="unfilled"><div id="aswift_0_host" style="border: none; height: 0px; width: 0px; margin: 0px; padding: 0px; position: relative; visibility: visible; background-color: transparent; display: inline-block;"><iframe id="aswift_0" name="aswift_0" browsingtopics="true" style="left:0;position:absolute;top:0;border:0;width:undefinedpx;height:undefinedpx;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allow="attribution-reporting; run-ad-auction" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/ads.html" data-google-container-id="a!1" tabindex="0" title="Advertisement" aria-label="Advertisement" data-load-complete="true"></iframe></div></ins><div id="modheader-shadow-root-host-el-id" style="display: initial !important;"><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://idgpnmonknjnojddfkpgkljpfnnfcklj/assets/AppVite-6c90dbf6.css"><style id="svelte-g289qm">#ModHeader-shadow-root{all:initial;font-size:16px;font-family:Roboto, sans-serif, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue !important}@tailwind base;@tailwind components;@tailwind utilities;</style><style id="svelte-4ht38r">#modheader-tool-suspend-btn.svelte-4ht38r{position:fixed;top:30vh;right:0;z-index:2147483640;transition:transform 0.3s;cursor:pointer;user-select:none;font-size:16px;visibility:hidden}#modheader-tool-suspend-btn.rest.svelte-4ht38r:hover{transform:translate(0, 0) !important}.suspend-btn.svelte-4ht38r{border-radius:50%;width:2.25em;height:2.25em}.memory-button.svelte-4ht38r{display:flex;width:100%;height:100%;border-radius:50%;align-items:center;justify-content:center;font-size:12px;font-weight:700;background-color:#56a9ff;color:white;box-shadow:0 3px 6px -1px rgba(0, 0, 0, 0.12), 0 10px 36px -4px rgba(77, 96, 232, 0.3);gap:1px;flex-wrap:wrap;line-height:1;zoom:0.94}.tooltip.svelte-4ht38r{position:absolute;top:0;bottom:0;height:min-content;margin:auto;font-size:12px;background-color:rgb(1, 1, 1, 0.9);font-weight:100;white-space:nowrap;color:#dddddd;padding:5px 9px;border-radius:5px;box-shadow:0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 9px 28px 8px rgba(0, 0, 0, 0.05);opacity:0;visibility:hidden;transition:visibility 0s linear 0.1s, opacity 0.1s linear}</style><div id="ModHeader-shadow-root" style="visibility: visible; opacity: 1; transition: visibility 0.3s ease 0s, opacity 0.3s ease 0s;"><div id="modheader-tool-suspend-btn" class="memory-view svelte-4ht38r" style="left: unset; right: 0px; top: 66.8945px; transform: translate(-1%, 0px); visibility: visible;"><button class="suspend-btn svelte-4ht38r" style="zoom: 0.675;"><div class="tooltip svelte-4ht38r" i18n="memory_btn_tooltip" style="visibility: hidden; opacity: 0;">page memory usage</div> <div class="memory-button svelte-4ht38r"><span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">271</font></font></span> <span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M.</font></font></span></div></button></div></div></template></div><iframe name="googlefcPresent" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/saved_resource(2).html"></iframe><ins class="adsbygoogle adsbygoogle-noablate" data-adsbygoogle-status="done" style="display: block; width: 100% !important; height: 129px !important; bottom: 0px; clear: none !important; float: none !important; left: 0px; margin: 0px !important; max-height: none !important; max-width: none !important; opacity: 1; overflow: visible !important; padding: 0px !important; position: fixed; right: auto !important; top: auto !important; vertical-align: baseline !important; visibility: visible !important; z-index: 2147483647; background: rgb(250, 250, 250) !important;" data-anchor-status="displayed" data-ad-status="filled" data-anchor-shown="true"><div class="grippy-host"><template shadowrootmode="closed"><ins class="ee" style="inset: auto !important; clear: none !important; display: block !important; float: none !important; height: 5px !important; margin: 0px !important; max-height: none !important; max-width: none !important; opacity: 1 !important; overflow: visible !important; padding: 0px !important; position: relative !important; vertical-align: baseline !important; visibility: visible !important; width: auto !important; z-index: 1 !important; background-color: rgb(250, 250, 250) !important; box-shadow: rgba(0, 0, 0, 0.2) 0px -1px 5px -1px, rgba(0, 0, 0, 0.1) 0px 1px 2px -1px !important;"><span style="display: block !important; width: 80px !important; height: 45px !important; bottom: 0px !important; left: 0% !important; pointer-events: none !important;"><svg style="margin: 0px !important; position: absolute !important; bottom: 0px !important; left: 0% !important; display: block !important; width: 80px !important; height: 30px !important; transform: none !important; pointer-events: initial !important;"><defs><filter id="dropShadowTop" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB"><fecomponenttransfer in="SourceAlpha" result="TransferredAlpha"><fefuncr type="discrete" tableValues="0.5"></fefuncr><fefuncg type="discrete" tableValues="0.5"></fefuncg><fefuncb type="discrete" tableValues="0.5"></fefuncb></fecomponenttransfer><fegaussianblur in="TransferredAlpha" stdDeviation="2"></fegaussianblur><feoffset dx="0" dy="0" result="offsetblur"></feoffset><femerge><femergenode></femergenode><femergenode in="SourceGraphic"></femergenode></femerge></filter></defs><path d="M0,26 L0,6 A6,6 0 0,1 6,1 L50,1 A6,6 0 0,1 56,6 L56,20 A6,6 0 0,0 62,26 Z" stroke="#FAFAFA" stroke-width="1" fill="#FAFAFA" style="filter: url(&quot;#dropShadowTop&quot;);"></path><rect x="0" y="25" width="80" height="5" style="fill: rgb(250, 250, 250);"></rect><g class="down" stroke="#616161" stroke-width="2px" stroke-linecap="square"><line x1="22" y1="12" x2="28" y2="18"></line><line x1="28" y1="18" x2="34" y2="12"></line></g></svg></span></ins></template></div><div id="aswift_6_host" style="border: none !important; height: 124px !important; width: 100% !important; margin: 0px !important; padding: 0px !important; position: relative !important; visibility: visible !important; background-color: transparent !important; display: inline-block !important; inset: auto !important; clear: none !important; float: none !important; max-height: none !important; max-width: none !important; opacity: 1 !important; overflow: visible !important; vertical-align: baseline !important; z-index: auto !important;"><iframe id="aswift_6" name="aswift_6" browsingtopics="true" style="width: 1005px !important; height: 124px !important; display: block; margin: 0px auto;" sandbox="allow-forms allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" width="1005" height="124" frameborder="0" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allow="attribution-reporting; run-ad-auction" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/zrt_lookup_fy2021.html" data-google-container-id="a!7" tabindex="0" title="Publicité" aria-label="Publicité" data-google-query-id="CMf_8cvg4oUDFZCXJwIdCQ8LdA" data-load-complete="true"></iframe></div></ins><iframe name="__tcfapiLocator" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/saved_resource(3).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="googlefcInactive" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/saved_resource(4).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><iframe name="googlefcLoaded" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/saved_resource(5).html" style="display: none; width: 0px; height: 0px; border: none; z-index: -1000; left: -1000px; top: -1000px;"></iframe><div id="goog-gt-tt" class="VIpgJd-yAWNEb-L7lbkb skiptranslate" style="border-radius: 12px; margin: 0 0 0 -23px; padding: 0; font-family: &#39;Google Sans&#39;, Arial, sans-serif;" data-id=""><div id="goog-gt-vt" class="VIpgJd-yAWNEb-hvhgNd"><div class=" VIpgJd-yAWNEb-hvhgNd-l4eHX-i3jM8c"><img src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/24px.svg" width="24" height="24" alt=""></div><div class=" VIpgJd-yAWNEb-hvhgNd-k77Iif-i3jM8c"><div class="VIpgJd-yAWNEb-hvhgNd-IuizWc" dir="ltr">Texte d'origine</div><div id="goog-gt-original-text" class="VIpgJd-yAWNEb-nVMfcd-fmcmS VIpgJd-yAWNEb-hvhgNd-axAV1"></div></div><div class="VIpgJd-yAWNEb-hvhgNd-N7Eqid ltr"><div class="VIpgJd-yAWNEb-hvhgNd-N7Eqid-B7I4Od ltr" dir="ltr"><div class="VIpgJd-yAWNEb-hvhgNd-UTujCb">Évaluez cette traduction</div><div class="VIpgJd-yAWNEb-hvhgNd-eO9mKe">Votre avis nous aidera à améliorer Google&nbsp;Traduction</div></div><div class="VIpgJd-yAWNEb-hvhgNd-xgov5 ltr"><button id="goog-gt-thumbUpButton" type="button" class="VIpgJd-yAWNEb-hvhgNd-bgm6sf" title="Bonne traduction" aria-label="Bonne traduction" aria-pressed="false"><span id="goog-gt-thumbUpIcon"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M21 7h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 0S7.08 6.85 7 7H2v13h16c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73V9c0-1.1-.9-2-2-2zM7 18H4V9h3v9zm14-7l-3 7H9V8l4.34-4.34L12 9h9v2z"></path></svg></span><span id="goog-gt-thumbUpIconFilled"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M21 7h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 0S7.08 6.85 7 7v13h11c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73V9c0-1.1-.9-2-2-2zM5 7H1v13h4V7z"></path></svg></span></button><button id="goog-gt-thumbDownButton" type="button" class="VIpgJd-yAWNEb-hvhgNd-bgm6sf" title="Mauvaise traduction" aria-label="Mauvaise traduction" aria-pressed="false"><span id="goog-gt-thumbDownIcon"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M3 17h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 24s7.09-6.85 7.17-7h5V4H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2zM17 6h3v9h-3V6zM3 13l3-7h9v10l-4.34 4.34L12 15H3v-2z"></path></svg></span><span id="goog-gt-thumbDownIconFilled"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M3 17h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 24s7.09-6.85 7.17-7V4H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2zm16 0h4V4h-4v13z"></path></svg></span></button></div></div><div id="goog-gt-votingHiddenPane" class="VIpgJd-yAWNEb-hvhgNd-aXYTce"><form id="goog-gt-votingForm" action="https://translate.googleapis.com/translate_voting?client=te_lib" method="post" target="votingFrame" class="VIpgJd-yAWNEb-hvhgNd-aXYTce"><input type="text" name="sl" id="goog-gt-votingInputSrcLang" data-np-intersection-state="observed"><input type="text" name="tl" id="goog-gt-votingInputTrgLang" data-np-intersection-state="observed"><input type="text" name="query" id="goog-gt-votingInputSrcText" data-np-intersection-state="observed"><input type="text" name="gtrans" id="goog-gt-votingInputTrgText" data-np-intersection-state="observed"><input type="text" name="vote" id="goog-gt-votingInputVote" data-np-intersection-state="observed"></form><iframe name="votingFrame" frameborder="0" src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/saved_resource(6).html"></iframe></div></div></div><iframe src="./fr-Apache Spark – Optimisation des performances et meilleures pratiques - DataForGeeks_files/aframe.html" width="0" height="0" style="display: none;"></iframe></body></html>